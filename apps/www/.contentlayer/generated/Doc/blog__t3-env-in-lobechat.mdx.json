{
  "title": "Lobechat applies typesafety to its environment variables\r",
  "published": false,
  "featured": false,
  "component": false,
  "toc": true,
  "body": {
    "raw": "\r\nIn this article, you will learn about T3 env and its usage with an example. We also analyze T3 env usage in [Lobechat](https://github.com/lobehub/lobe-chat/blob/main/src/config/db.ts).\r\n\r\n![](https://cdn-images-1.medium.com/max/1600/1*zwtM_FoWfJP0PHPq_3MIUA.png)\r\n\r\n### T3 env\r\n\r\nWhen you visit [T3 env website](https://env.t3.gg/), it has this hero title â€œFramework agnostic validation for type-safe environment variables.â€ with this descriptionâ€Šâ€”â€Šâ€œNever build your apps with invalid environment variables again. Validate and transform your environment with the full power of Zod.â€\r\n\r\nYou can use T3 env to apply type-safe validations on your environment variables so you donâ€™t end up deploying an application with invalid env variables. but how do you apply these validations? letâ€™s find out.\r\n\r\n#### Installation\r\n\r\nUse the below command to install T3 env in your project.\r\n\r\n```plaintext\r\n# Core package, no framework specific features\r\npnpm add @t3-oss/env-core zod\r\n# or, with options preconfigured for Next.js\r\npnpm add @t3-oss/env-nextjs zod\r\n```\r\n\r\n#### Usage\r\n\r\nT3 env usage is simple, you would first have to define your schema as shown below:\r\n\r\n```plaintext\r\n// src/env.mjs\r\nimport { createEnv } from \"@t3-oss/env-nextjs\";\r\nimport { z } from \"zod\";\r\nexport const env = createEnv({\r\n /*\r\n * Serverside Environment variables, not available on the client.\r\n * Will throw if you access these variables on the client.\r\n */\r\n server: {\r\n DATABASE_URL: z.string().url(),\r\n OPEN_AI_API_KEY: z.string().min(1),\r\n },\r\n /*\r\n * Environment variables available on the client (and server).\r\n *\r\n * ðŸ’¡ You'll get type errors if these are not prefixed with NEXT_PUBLIC_.\r\n */\r\n client: {\r\n NEXT_PUBLIC_CLERK_PUBLISHABLE_KEY: z.string().min(1),\r\n },\r\n /*\r\n * Due to how Next.js bundles environment variables on Edge and Client,\r\n * we need to manually destructure them to make sure all are included in bundle.\r\n *\r\n * ðŸ’¡ You'll get type errors if not all variables from `server` & `client` are included here.\r\n */\r\n runtimeEnv: {\r\n DATABASE_URL: process.env.DATABASE_URL,\r\n OPEN_AI_API_KEY: process.env.OPEN_AI_API_KEY,\r\n NEXT_PUBLIC_CLERK_PUBLISHABLE_KEY:\r\n process.env.NEXT_PUBLIC_CLERK_PUBLISHABLE_KEY,\r\n },\r\n});\r\n```\r\n\r\n[Github docs for T3 env](https://github.com/t3-oss/t3-env?tab=readme-ov-file#define-your-schema) provides Next.js based example. Pay extra attention to the comments provided in the above example. Since Next.js is a full-stack framework, you have env variables for server and client and you need to be careful to not expose your server side enviroment variables toÂ   \r\nclient.\r\n\r\nT3 env requires you to define your server env types in server object in schema.\r\n\r\n```plaintext\r\n/*\r\n* Serverside Environment variables, not available on the client.\r\n* Will throw if you access these variables on the client.\r\n*/\r\nserver: {\r\n DATABASE_URL: z.string().url(),\r\n OPEN_AI_API_KEY: z.string().min(1),\r\n},\r\n```\r\n\r\nSimilarly, define the types for the client side environment variables\r\n\r\n```plaintext\r\n/*\r\n * Environment variables available on the client (and server).\r\n *\r\n * ðŸ’¡ You'll get type errors if these are not prefixed with NEXT_PUBLIC_.\r\n*/\r\nclient: {\r\n NEXT_PUBLIC_CLERK_PUBLISHABLE_KEY: z.string().min(1),\r\n},\r\n```\r\n\r\nSo far, we only defined the variables and their types on the client and server side. Next step is to define runtimeEnv.\r\n\r\n```plaintext\r\n/*\r\n* Due to how Next.js bundles environment variables on Edge and Client,\r\n* we need to manually destructure them to make sure all are included in bundle.\r\n*\r\n* ðŸ’¡ You'll get type errors if not all variables from `server` & `client` are included here.\r\n*/\r\nruntimeEnv: {\r\n DATABASE_URL: process.env.DATABASE_URL,\r\n OPEN_AI_API_KEY: process.env.OPEN_AI_API_KEY,\r\n NEXT_PUBLIC_CLERK_PUBLISHABLE_KEY:\r\n process.env.NEXT_PUBLIC_CLERK_PUBLISHABLE_KEY,\r\n},\r\n```\r\n\r\n#### Use the schema in your app with autocompletion and type inference\r\n\r\n```plaintext\r\n// src/app/hello/route.ts\r\nimport { env } from \"../env.mjs\";\r\nexport const GET = (req: Request) => {\r\n const DATABASE_URL = env.DATABASE_URL;\r\n // use itâ€¦\r\n};\r\n```\r\n\r\nYou can import env in the file that requires it and you now have type-safety applied to your env variables withÂ   \r\nauto-completion.\r\n\r\n### Lobechat usage of T3Â env\r\n\r\nLobechat defines the schema, as explained above, in [src/config/db.ts](https://github.com/lobehub/lobe-chat/blob/main/src/config/db.ts).\r\n\r\n```plaintext\r\nimport { createEnv } from '@t3-oss/env-nextjs';\r\nimport { z } from 'zod';\r\nexport const getServerDBConfig = () => {\r\n return createEnv({\r\n client: {\r\n NEXT_PUBLIC_ENABLED_SERVER_SERVICE: z.boolean(),\r\n },\r\n runtimeEnv: {\r\n DATABASE_DRIVER: process.env.DATABASE_DRIVER || 'neon',\r\n DATABASE_TEST_URL: process.env.DATABASE_TEST_URL,\r\n DATABASE_URL: process.env.DATABASE_URL,\r\nDISABLE_REMOVE_GLOBAL_FILE: process.env.DISABLE_REMOVE_GLOBAL_FILE === '1',\r\nKEY_VAULTS_SECRET: process.env.KEY_VAULTS_SECRET,\r\nNEXT_PUBLIC_ENABLED_SERVER_SERVICE: process.env.NEXT_PUBLIC_SERVICE_MODE === 'server',\r\n },\r\n server: {\r\n DATABASE_DRIVER: z.enum(['neon', 'node']),\r\n DATABASE_TEST_URL: z.string().optional(),\r\n DATABASE_URL: z.string().optional(),\r\nDISABLE_REMOVE_GLOBAL_FILE: z.boolean().optional(),\r\nKEY_VAULTS_SECRET: z.string().optional(),\r\n },\r\n });\r\n};\r\nexport const serverDBEnv = getServerDBConfig();\r\n```\r\n\r\nThis serverDBEnv is used in [server/core/db.ts](https://github.com/lobehub/lobe-chat/blob/main/src/database/server/core/db.ts#L7).\r\n\r\nUsage example:\r\n\r\n```plaintext\r\nimport { serverDBEnv } from '@/config/db';\r\n//\r\nlet connectionString = serverDBEnv.DATABASE_URL;\r\n```\r\n\r\n# **About me:**\r\n\r\nHey, my name is Ramu Narasinga. I study large open-source projects and create content about their codebase architecture and best practices, sharing it through articles, videos.\r\n\r\nI am open to work on interesting projects. Send me an email at ramu.narasinga@gmail.com\r\n\r\nMy Github â€” [https://github.com/ramu-narasinga](https://github.com/ramu-narasinga)\r\n\r\nMy website â€” [https://ramunarasinga.com](https://ramunarasinga.com/)\r\n\r\nMy Youtube channel â€” [https://www.youtube.com/@thinkthroo](https://www.youtube.com/@thinkthroo)\r\n\r\nLearning platform â€” [https://thinkthroo.com](https://thinkthroo.com/)\r\n\r\nCodebase Architecture â€” [https://app.thinkthroo.com/architecture](https://app.thinkthroo.com/architecture)\r\n\r\nBest practices â€” [https://app.thinkthroo.com/best-practices](https://app.thinkthroo.com/best-practices)\r\n\r\nProduction-grade projects â€” [https://app.thinkthroo.com/production-grade-projects](https://app.thinkthroo.com/production-grade-projects)\r\n\r\n### References\r\n\r\n1\\. https://github.com/t3-oss/t3-env  \r\n2\\. https://github.com/lobehub/lobe-chat/blob/main/src/config/db.ts  \r\n3\\. https://env.t3.gg/",
    "code": "var Component=(()=>{var o=Object.create;var l=Object.defineProperty;var m=Object.getOwnPropertyDescriptor;var u=Object.getOwnPropertyNames;var v=Object.getPrototypeOf,N=Object.prototype.hasOwnProperty;var g=(a,e)=>()=>(e||a((e={exports:{}}).exports,e),e.exports),E=(a,e)=>{for(var s in e)l(a,s,{get:e[s],enumerable:!0})},c=(a,e,s,r)=>{if(e&&typeof e==\"object\"||typeof e==\"function\")for(let i of u(e))!N.call(a,i)&&i!==s&&l(a,i,{get:()=>e[i],enumerable:!(r=m(e,i))||r.enumerable});return a};var b=(a,e,s)=>(s=a!=null?o(v(a)):{},c(e||!a||!a.__esModule?l(s,\"default\",{value:a,enumerable:!0}):s,a)),f=a=>c(l({},\"__esModule\",{value:!0}),a);var d=g((L,t)=>{t.exports=_jsx_runtime});var A={};E(A,{default:()=>p,frontmatter:()=>_});var n=b(d()),_={title:\"Lobechat applies typesafety to its environment variables\"};function h(a){let e={a:\"a\",br:\"br\",code:\"code\",div:\"div\",h1:\"h1\",h3:\"h3\",h4:\"h4\",img:\"img\",p:\"p\",pre:\"pre\",span:\"span\",strong:\"strong\",...a.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(e.p,{children:[\"In this article, you will learn about T3 env and its usage with an example. We also analyze T3 env usage in \",(0,n.jsx)(e.a,{href:\"https://github.com/lobehub/lobe-chat/blob/main/src/config/db.ts\",children:\"Lobechat\"}),\".\"]}),`\n`,(0,n.jsx)(e.p,{children:(0,n.jsx)(e.img,{src:\"https://cdn-images-1.medium.com/max/1600/1*zwtM_FoWfJP0PHPq_3MIUA.png\",alt:\"\"})}),`\n`,(0,n.jsx)(e.h3,{id:\"t3-env\",children:\"T3 env\"}),`\n`,(0,n.jsxs)(e.p,{children:[\"When you visit \",(0,n.jsx)(e.a,{href:\"https://env.t3.gg/\",children:\"T3 env website\"}),\", it has this hero title \\u201CFramework agnostic validation for type-safe environment variables.\\u201D with this description\\u200A\\u2014\\u200A\\u201CNever build your apps with invalid environment variables again. Validate and transform your environment with the full power of Zod.\\u201D\"]}),`\n`,(0,n.jsx)(e.p,{children:\"You can use T3 env to apply type-safe validations on your environment variables so you don\\u2019t end up deploying an application with invalid env variables. but how do you apply these validations? let\\u2019s find out.\"}),`\n`,(0,n.jsx)(e.h4,{id:\"installation\",children:\"Installation\"}),`\n`,(0,n.jsx)(e.p,{children:\"Use the below command to install T3 env in your project.\"}),`\n`,(0,n.jsx)(e.div,{\"data-rehype-pretty-code-fragment\":\"\",children:(0,n.jsx)(e.pre,{\"data-language\":\"plaintext\",\"data-theme\":\"default\",children:(0,n.jsxs)(e.code,{\"data-language\":\"plaintext\",\"data-theme\":\"default\",children:[(0,n.jsx)(e.span,{className:\"line\",children:(0,n.jsx)(e.span,{children:\"# Core package, no framework specific features\"})}),`\n`,(0,n.jsx)(e.span,{className:\"line\",children:(0,n.jsx)(e.span,{children:\"pnpm add @t3-oss/env-core zod\"})}),`\n`,(0,n.jsx)(e.span,{className:\"line\",children:(0,n.jsx)(e.span,{children:\"# or, with options preconfigured for Next.js\"})}),`\n`,(0,n.jsx)(e.span,{className:\"line\",children:(0,n.jsx)(e.span,{children:\"pnpm add @t3-oss/env-nextjs zod\"})})]})})}),`\n`,(0,n.jsx)(e.h4,{id:\"usage\",children:\"Usage\"}),`\n`,(0,n.jsx)(e.p,{children:\"T3 env usage is simple, you would first have to define your schema as shown below:\"}),`\n`,(0,n.jsx)(e.div,{\"data-rehype-pretty-code-fragment\":\"\",children:(0,n.jsx)(e.pre,{\"data-language\":\"plaintext\",\"data-theme\":\"default\",children:(0,n.jsxs)(e.code,{\"data-language\":\"plaintext\",\"data-theme\":\"default\",children:[(0,n.jsx)(e.span,{className:\"line\",children:(0,n.jsx)(e.span,{children:\"// src/env.mjs\"})}),`\n`,(0,n.jsx)(e.span,{className:\"line\",children:(0,n.jsx)(e.span,{children:'import { createEnv } from \"@t3-oss/env-nextjs\";'})}),`\n`,(0,n.jsx)(e.span,{className:\"line\",children:(0,n.jsx)(e.span,{children:'import { z } from \"zod\";'})}),`\n`,(0,n.jsx)(e.span,{className:\"line\",children:(0,n.jsx)(e.span,{children:\"export const env = createEnv({\"})}),`\n`,(0,n.jsx)(e.span,{className:\"line\",children:(0,n.jsx)(e.span,{children:\" /*\"})}),`\n`,(0,n.jsx)(e.span,{className:\"line\",children:(0,n.jsx)(e.span,{children:\" * Serverside Environment variables, not available on the client.\"})}),`\n`,(0,n.jsx)(e.span,{className:\"line\",children:(0,n.jsx)(e.span,{children:\" * Will throw if you access these variables on the client.\"})}),`\n`,(0,n.jsx)(e.span,{className:\"line\",children:(0,n.jsx)(e.span,{children:\" */\"})}),`\n`,(0,n.jsx)(e.span,{className:\"line\",children:(0,n.jsx)(e.span,{children:\" server: {\"})}),`\n`,(0,n.jsx)(e.span,{className:\"line\",children:(0,n.jsx)(e.span,{children:\" DATABASE_URL: z.string().url(),\"})}),`\n`,(0,n.jsx)(e.span,{className:\"line\",children:(0,n.jsx)(e.span,{children:\" OPEN_AI_API_KEY: z.string().min(1),\"})}),`\n`,(0,n.jsx)(e.span,{className:\"line\",children:(0,n.jsx)(e.span,{children:\" },\"})}),`\n`,(0,n.jsx)(e.span,{className:\"line\",children:(0,n.jsx)(e.span,{children:\" /*\"})}),`\n`,(0,n.jsx)(e.span,{className:\"line\",children:(0,n.jsx)(e.span,{children:\" * Environment variables available on the client (and server).\"})}),`\n`,(0,n.jsx)(e.span,{className:\"line\",children:(0,n.jsx)(e.span,{children:\" *\"})}),`\n`,(0,n.jsx)(e.span,{className:\"line\",children:(0,n.jsx)(e.span,{children:\" * \\u{1F4A1} You'll get type errors if these are not prefixed with NEXT_PUBLIC_.\"})}),`\n`,(0,n.jsx)(e.span,{className:\"line\",children:(0,n.jsx)(e.span,{children:\" */\"})}),`\n`,(0,n.jsx)(e.span,{className:\"line\",children:(0,n.jsx)(e.span,{children:\" client: {\"})}),`\n`,(0,n.jsx)(e.span,{className:\"line\",children:(0,n.jsx)(e.span,{children:\" NEXT_PUBLIC_CLERK_PUBLISHABLE_KEY: z.string().min(1),\"})}),`\n`,(0,n.jsx)(e.span,{className:\"line\",children:(0,n.jsx)(e.span,{children:\" },\"})}),`\n`,(0,n.jsx)(e.span,{className:\"line\",children:(0,n.jsx)(e.span,{children:\" /*\"})}),`\n`,(0,n.jsx)(e.span,{className:\"line\",children:(0,n.jsx)(e.span,{children:\" * Due to how Next.js bundles environment variables on Edge and Client,\"})}),`\n`,(0,n.jsx)(e.span,{className:\"line\",children:(0,n.jsx)(e.span,{children:\" * we need to manually destructure them to make sure all are included in bundle.\"})}),`\n`,(0,n.jsx)(e.span,{className:\"line\",children:(0,n.jsx)(e.span,{children:\" *\"})}),`\n`,(0,n.jsx)(e.span,{className:\"line\",children:(0,n.jsx)(e.span,{children:\" * \\u{1F4A1} You'll get type errors if not all variables from `server` & `client` are included here.\"})}),`\n`,(0,n.jsx)(e.span,{className:\"line\",children:(0,n.jsx)(e.span,{children:\" */\"})}),`\n`,(0,n.jsx)(e.span,{className:\"line\",children:(0,n.jsx)(e.span,{children:\" runtimeEnv: {\"})}),`\n`,(0,n.jsx)(e.span,{className:\"line\",children:(0,n.jsx)(e.span,{children:\" DATABASE_URL: process.env.DATABASE_URL,\"})}),`\n`,(0,n.jsx)(e.span,{className:\"line\",children:(0,n.jsx)(e.span,{children:\" OPEN_AI_API_KEY: process.env.OPEN_AI_API_KEY,\"})}),`\n`,(0,n.jsx)(e.span,{className:\"line\",children:(0,n.jsx)(e.span,{children:\" NEXT_PUBLIC_CLERK_PUBLISHABLE_KEY:\"})}),`\n`,(0,n.jsx)(e.span,{className:\"line\",children:(0,n.jsx)(e.span,{children:\" process.env.NEXT_PUBLIC_CLERK_PUBLISHABLE_KEY,\"})}),`\n`,(0,n.jsx)(e.span,{className:\"line\",children:(0,n.jsx)(e.span,{children:\" },\"})}),`\n`,(0,n.jsx)(e.span,{className:\"line\",children:(0,n.jsx)(e.span,{children:\"});\"})})]})})}),`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.a,{href:\"https://github.com/t3-oss/t3-env?tab=readme-ov-file#define-your-schema\",children:\"Github docs for T3 env\"}),\" provides Next.js based example. Pay extra attention to the comments provided in the above example. Since Next.js is a full-stack framework, you have env variables for server and client and you need to be careful to not expose your server side enviroment variables to\\xA0\",(0,n.jsx)(e.br,{}),`\n`,\"client.\"]}),`\n`,(0,n.jsx)(e.p,{children:\"T3 env requires you to define your server env types in server object in schema.\"}),`\n`,(0,n.jsx)(e.div,{\"data-rehype-pretty-code-fragment\":\"\",children:(0,n.jsx)(e.pre,{\"data-language\":\"plaintext\",\"data-theme\":\"default\",children:(0,n.jsxs)(e.code,{\"data-language\":\"plaintext\",\"data-theme\":\"default\",children:[(0,n.jsx)(e.span,{className:\"line\",children:(0,n.jsx)(e.span,{children:\"/*\"})}),`\n`,(0,n.jsx)(e.span,{className:\"line\",children:(0,n.jsx)(e.span,{children:\"* Serverside Environment variables, not available on the client.\"})}),`\n`,(0,n.jsx)(e.span,{className:\"line\",children:(0,n.jsx)(e.span,{children:\"* Will throw if you access these variables on the client.\"})}),`\n`,(0,n.jsx)(e.span,{className:\"line\",children:(0,n.jsx)(e.span,{children:\"*/\"})}),`\n`,(0,n.jsx)(e.span,{className:\"line\",children:(0,n.jsx)(e.span,{children:\"server: {\"})}),`\n`,(0,n.jsx)(e.span,{className:\"line\",children:(0,n.jsx)(e.span,{children:\" DATABASE_URL: z.string().url(),\"})}),`\n`,(0,n.jsx)(e.span,{className:\"line\",children:(0,n.jsx)(e.span,{children:\" OPEN_AI_API_KEY: z.string().min(1),\"})}),`\n`,(0,n.jsx)(e.span,{className:\"line\",children:(0,n.jsx)(e.span,{children:\"},\"})})]})})}),`\n`,(0,n.jsx)(e.p,{children:\"Similarly, define the types for the client side environment variables\"}),`\n`,(0,n.jsx)(e.div,{\"data-rehype-pretty-code-fragment\":\"\",children:(0,n.jsx)(e.pre,{\"data-language\":\"plaintext\",\"data-theme\":\"default\",children:(0,n.jsxs)(e.code,{\"data-language\":\"plaintext\",\"data-theme\":\"default\",children:[(0,n.jsx)(e.span,{className:\"line\",children:(0,n.jsx)(e.span,{children:\"/*\"})}),`\n`,(0,n.jsx)(e.span,{className:\"line\",children:(0,n.jsx)(e.span,{children:\" * Environment variables available on the client (and server).\"})}),`\n`,(0,n.jsx)(e.span,{className:\"line\",children:(0,n.jsx)(e.span,{children:\" *\"})}),`\n`,(0,n.jsx)(e.span,{className:\"line\",children:(0,n.jsx)(e.span,{children:\" * \\u{1F4A1} You'll get type errors if these are not prefixed with NEXT_PUBLIC_.\"})}),`\n`,(0,n.jsx)(e.span,{className:\"line\",children:(0,n.jsx)(e.span,{children:\"*/\"})}),`\n`,(0,n.jsx)(e.span,{className:\"line\",children:(0,n.jsx)(e.span,{children:\"client: {\"})}),`\n`,(0,n.jsx)(e.span,{className:\"line\",children:(0,n.jsx)(e.span,{children:\" NEXT_PUBLIC_CLERK_PUBLISHABLE_KEY: z.string().min(1),\"})}),`\n`,(0,n.jsx)(e.span,{className:\"line\",children:(0,n.jsx)(e.span,{children:\"},\"})})]})})}),`\n`,(0,n.jsx)(e.p,{children:\"So far, we only defined the variables and their types on the client and server side. Next step is to define runtimeEnv.\"}),`\n`,(0,n.jsx)(e.div,{\"data-rehype-pretty-code-fragment\":\"\",children:(0,n.jsx)(e.pre,{\"data-language\":\"plaintext\",\"data-theme\":\"default\",children:(0,n.jsxs)(e.code,{\"data-language\":\"plaintext\",\"data-theme\":\"default\",children:[(0,n.jsx)(e.span,{className:\"line\",children:(0,n.jsx)(e.span,{children:\"/*\"})}),`\n`,(0,n.jsx)(e.span,{className:\"line\",children:(0,n.jsx)(e.span,{children:\"* Due to how Next.js bundles environment variables on Edge and Client,\"})}),`\n`,(0,n.jsx)(e.span,{className:\"line\",children:(0,n.jsx)(e.span,{children:\"* we need to manually destructure them to make sure all are included in bundle.\"})}),`\n`,(0,n.jsx)(e.span,{className:\"line\",children:(0,n.jsx)(e.span,{children:\"*\"})}),`\n`,(0,n.jsx)(e.span,{className:\"line\",children:(0,n.jsx)(e.span,{children:\"* \\u{1F4A1} You'll get type errors if not all variables from `server` & `client` are included here.\"})}),`\n`,(0,n.jsx)(e.span,{className:\"line\",children:(0,n.jsx)(e.span,{children:\"*/\"})}),`\n`,(0,n.jsx)(e.span,{className:\"line\",children:(0,n.jsx)(e.span,{children:\"runtimeEnv: {\"})}),`\n`,(0,n.jsx)(e.span,{className:\"line\",children:(0,n.jsx)(e.span,{children:\" DATABASE_URL: process.env.DATABASE_URL,\"})}),`\n`,(0,n.jsx)(e.span,{className:\"line\",children:(0,n.jsx)(e.span,{children:\" OPEN_AI_API_KEY: process.env.OPEN_AI_API_KEY,\"})}),`\n`,(0,n.jsx)(e.span,{className:\"line\",children:(0,n.jsx)(e.span,{children:\" NEXT_PUBLIC_CLERK_PUBLISHABLE_KEY:\"})}),`\n`,(0,n.jsx)(e.span,{className:\"line\",children:(0,n.jsx)(e.span,{children:\" process.env.NEXT_PUBLIC_CLERK_PUBLISHABLE_KEY,\"})}),`\n`,(0,n.jsx)(e.span,{className:\"line\",children:(0,n.jsx)(e.span,{children:\"},\"})})]})})}),`\n`,(0,n.jsx)(e.h4,{id:\"use-the-schema-in-your-app-with-autocompletion-and-type-inference\",children:\"Use the schema in your app with autocompletion and type inference\"}),`\n`,(0,n.jsx)(e.div,{\"data-rehype-pretty-code-fragment\":\"\",children:(0,n.jsx)(e.pre,{\"data-language\":\"plaintext\",\"data-theme\":\"default\",children:(0,n.jsxs)(e.code,{\"data-language\":\"plaintext\",\"data-theme\":\"default\",children:[(0,n.jsx)(e.span,{className:\"line\",children:(0,n.jsx)(e.span,{children:\"// src/app/hello/route.ts\"})}),`\n`,(0,n.jsx)(e.span,{className:\"line\",children:(0,n.jsx)(e.span,{children:'import { env } from \"../env.mjs\";'})}),`\n`,(0,n.jsx)(e.span,{className:\"line\",children:(0,n.jsx)(e.span,{children:\"export const GET = (req: Request) => {\"})}),`\n`,(0,n.jsx)(e.span,{className:\"line\",children:(0,n.jsx)(e.span,{children:\" const DATABASE_URL = env.DATABASE_URL;\"})}),`\n`,(0,n.jsx)(e.span,{className:\"line\",children:(0,n.jsx)(e.span,{children:\" // use it\\u2026\"})}),`\n`,(0,n.jsx)(e.span,{className:\"line\",children:(0,n.jsx)(e.span,{children:\"};\"})})]})})}),`\n`,(0,n.jsxs)(e.p,{children:[\"You can import env in the file that requires it and you now have type-safety applied to your env variables with\\xA0\",(0,n.jsx)(e.br,{}),`\n`,\"auto-completion.\"]}),`\n`,(0,n.jsx)(e.h3,{id:\"lobechat-usage-of-t3env\",children:\"Lobechat usage of T3\\xA0env\"}),`\n`,(0,n.jsxs)(e.p,{children:[\"Lobechat defines the schema, as explained above, in \",(0,n.jsx)(e.a,{href:\"https://github.com/lobehub/lobe-chat/blob/main/src/config/db.ts\",children:\"src/config/db.ts\"}),\".\"]}),`\n`,(0,n.jsx)(e.div,{\"data-rehype-pretty-code-fragment\":\"\",children:(0,n.jsx)(e.pre,{\"data-language\":\"plaintext\",\"data-theme\":\"default\",children:(0,n.jsxs)(e.code,{\"data-language\":\"plaintext\",\"data-theme\":\"default\",children:[(0,n.jsx)(e.span,{className:\"line\",children:(0,n.jsx)(e.span,{children:\"import { createEnv } from '@t3-oss/env-nextjs';\"})}),`\n`,(0,n.jsx)(e.span,{className:\"line\",children:(0,n.jsx)(e.span,{children:\"import { z } from 'zod';\"})}),`\n`,(0,n.jsx)(e.span,{className:\"line\",children:(0,n.jsx)(e.span,{children:\"export const getServerDBConfig = () => {\"})}),`\n`,(0,n.jsx)(e.span,{className:\"line\",children:(0,n.jsx)(e.span,{children:\" return createEnv({\"})}),`\n`,(0,n.jsx)(e.span,{className:\"line\",children:(0,n.jsx)(e.span,{children:\" client: {\"})}),`\n`,(0,n.jsx)(e.span,{className:\"line\",children:(0,n.jsx)(e.span,{children:\" NEXT_PUBLIC_ENABLED_SERVER_SERVICE: z.boolean(),\"})}),`\n`,(0,n.jsx)(e.span,{className:\"line\",children:(0,n.jsx)(e.span,{children:\" },\"})}),`\n`,(0,n.jsx)(e.span,{className:\"line\",children:(0,n.jsx)(e.span,{children:\" runtimeEnv: {\"})}),`\n`,(0,n.jsx)(e.span,{className:\"line\",children:(0,n.jsx)(e.span,{children:\" DATABASE_DRIVER: process.env.DATABASE_DRIVER || 'neon',\"})}),`\n`,(0,n.jsx)(e.span,{className:\"line\",children:(0,n.jsx)(e.span,{children:\" DATABASE_TEST_URL: process.env.DATABASE_TEST_URL,\"})}),`\n`,(0,n.jsx)(e.span,{className:\"line\",children:(0,n.jsx)(e.span,{children:\" DATABASE_URL: process.env.DATABASE_URL,\"})}),`\n`,(0,n.jsx)(e.span,{className:\"line\",children:(0,n.jsx)(e.span,{children:\"DISABLE_REMOVE_GLOBAL_FILE: process.env.DISABLE_REMOVE_GLOBAL_FILE === '1',\"})}),`\n`,(0,n.jsx)(e.span,{className:\"line\",children:(0,n.jsx)(e.span,{children:\"KEY_VAULTS_SECRET: process.env.KEY_VAULTS_SECRET,\"})}),`\n`,(0,n.jsx)(e.span,{className:\"line\",children:(0,n.jsx)(e.span,{children:\"NEXT_PUBLIC_ENABLED_SERVER_SERVICE: process.env.NEXT_PUBLIC_SERVICE_MODE === 'server',\"})}),`\n`,(0,n.jsx)(e.span,{className:\"line\",children:(0,n.jsx)(e.span,{children:\" },\"})}),`\n`,(0,n.jsx)(e.span,{className:\"line\",children:(0,n.jsx)(e.span,{children:\" server: {\"})}),`\n`,(0,n.jsx)(e.span,{className:\"line\",children:(0,n.jsx)(e.span,{children:\" DATABASE_DRIVER: z.enum(['neon', 'node']),\"})}),`\n`,(0,n.jsx)(e.span,{className:\"line\",children:(0,n.jsx)(e.span,{children:\" DATABASE_TEST_URL: z.string().optional(),\"})}),`\n`,(0,n.jsx)(e.span,{className:\"line\",children:(0,n.jsx)(e.span,{children:\" DATABASE_URL: z.string().optional(),\"})}),`\n`,(0,n.jsx)(e.span,{className:\"line\",children:(0,n.jsx)(e.span,{children:\"DISABLE_REMOVE_GLOBAL_FILE: z.boolean().optional(),\"})}),`\n`,(0,n.jsx)(e.span,{className:\"line\",children:(0,n.jsx)(e.span,{children:\"KEY_VAULTS_SECRET: z.string().optional(),\"})}),`\n`,(0,n.jsx)(e.span,{className:\"line\",children:(0,n.jsx)(e.span,{children:\" },\"})}),`\n`,(0,n.jsx)(e.span,{className:\"line\",children:(0,n.jsx)(e.span,{children:\" });\"})}),`\n`,(0,n.jsx)(e.span,{className:\"line\",children:(0,n.jsx)(e.span,{children:\"};\"})}),`\n`,(0,n.jsx)(e.span,{className:\"line\",children:(0,n.jsx)(e.span,{children:\"export const serverDBEnv = getServerDBConfig();\"})})]})})}),`\n`,(0,n.jsxs)(e.p,{children:[\"This serverDBEnv is used in \",(0,n.jsx)(e.a,{href:\"https://github.com/lobehub/lobe-chat/blob/main/src/database/server/core/db.ts#L7\",children:\"server/core/db.ts\"}),\".\"]}),`\n`,(0,n.jsx)(e.p,{children:\"Usage example:\"}),`\n`,(0,n.jsx)(e.div,{\"data-rehype-pretty-code-fragment\":\"\",children:(0,n.jsx)(e.pre,{\"data-language\":\"plaintext\",\"data-theme\":\"default\",children:(0,n.jsxs)(e.code,{\"data-language\":\"plaintext\",\"data-theme\":\"default\",children:[(0,n.jsx)(e.span,{className:\"line\",children:(0,n.jsx)(e.span,{children:\"import { serverDBEnv } from '@/config/db';\"})}),`\n`,(0,n.jsx)(e.span,{className:\"line\",children:(0,n.jsx)(e.span,{children:\"//\"})}),`\n`,(0,n.jsx)(e.span,{className:\"line\",children:(0,n.jsx)(e.span,{children:\"let connectionString = serverDBEnv.DATABASE_URL;\"})})]})})}),`\n`,(0,n.jsx)(e.h1,{id:\"about-me\",children:(0,n.jsx)(e.strong,{children:\"About me:\"})}),`\n`,(0,n.jsx)(e.p,{children:\"Hey, my name is Ramu Narasinga. I study large open-source projects and create content about their codebase architecture and best practices, sharing it through articles, videos.\"}),`\n`,(0,n.jsxs)(e.p,{children:[\"I am open to work on interesting projects. Send me an email at \",(0,n.jsx)(e.a,{href:\"mailto:ramu.narasinga@gmail.com\",children:\"ramu.narasinga@gmail.com\"})]}),`\n`,(0,n.jsxs)(e.p,{children:[\"My Github \\u2014 \",(0,n.jsx)(e.a,{href:\"https://github.com/ramu-narasinga\",children:\"https://github.com/ramu-narasinga\"})]}),`\n`,(0,n.jsxs)(e.p,{children:[\"My website \\u2014 \",(0,n.jsx)(e.a,{href:\"https://ramunarasinga.com/\",children:\"https://ramunarasinga.com\"})]}),`\n`,(0,n.jsxs)(e.p,{children:[\"My Youtube channel \\u2014 \",(0,n.jsx)(e.a,{href:\"https://www.youtube.com/@thinkthroo\",children:\"https://www.youtube.com/@thinkthroo\"})]}),`\n`,(0,n.jsxs)(e.p,{children:[\"Learning platform \\u2014 \",(0,n.jsx)(e.a,{href:\"https://thinkthroo.com/\",children:\"https://thinkthroo.com\"})]}),`\n`,(0,n.jsxs)(e.p,{children:[\"Codebase Architecture \\u2014 \",(0,n.jsx)(e.a,{href:\"https://app.thinkthroo.com/architecture\",children:\"https://app.thinkthroo.com/architecture\"})]}),`\n`,(0,n.jsxs)(e.p,{children:[\"Best practices \\u2014 \",(0,n.jsx)(e.a,{href:\"https://app.thinkthroo.com/best-practices\",children:\"https://app.thinkthroo.com/best-practices\"})]}),`\n`,(0,n.jsxs)(e.p,{children:[\"Production-grade projects \\u2014 \",(0,n.jsx)(e.a,{href:\"https://app.thinkthroo.com/production-grade-projects\",children:\"https://app.thinkthroo.com/production-grade-projects\"})]}),`\n`,(0,n.jsx)(e.h3,{id:\"references\",children:\"References\"}),`\n`,(0,n.jsxs)(e.p,{children:[\"1. \",(0,n.jsx)(e.a,{href:\"https://github.com/t3-oss/t3-env\",children:\"https://github.com/t3-oss/t3-env\"}),(0,n.jsx)(e.br,{}),`\n`,\"2. \",(0,n.jsx)(e.a,{href:\"https://github.com/lobehub/lobe-chat/blob/main/src/config/db.ts\",children:\"https://github.com/lobehub/lobe-chat/blob/main/src/config/db.ts\"}),(0,n.jsx)(e.br,{}),`\n`,\"3. \",(0,n.jsx)(e.a,{href:\"https://env.t3.gg/\",children:\"https://env.t3.gg/\"})]})]})}function p(a={}){let{wrapper:e}=a.components||{};return e?(0,n.jsx)(e,{...a,children:(0,n.jsx)(h,{...a})}):h(a)}return f(A);})();\n;return Component;"
  },
  "_id": "blog/t3-env-in-lobechat.mdx",
  "_raw": {
    "sourceFilePath": "blog/t3-env-in-lobechat.mdx",
    "sourceFileName": "t3-env-in-lobechat.mdx",
    "sourceFileDir": "blog",
    "contentType": "mdx",
    "flattenedPath": "blog/t3-env-in-lobechat"
  },
  "type": "Doc",
  "slug": "/blog/t3-env-in-lobechat",
  "slugAsParams": "t3-env-in-lobechat"
}