{
  "title": "How Documenso, an open-source Docusign alternative, handles pdf file upload in Next.js?\r",
  "published": false,
  "featured": false,
  "component": false,
  "toc": true,
  "body": {
    "raw": "\r\nIn this article, we analyse how [Documenso](https://github.com/documenso/documenso/blob/main/apps/web/src/app/%28dashboard%29/documents/upload-document.tsx#L65)[,](https://github.com/documenso/documenso/blob/main/apps/web/src/app/%28dashboard%29/documents/upload-document.tsx#L65%29,) an open-source Docusign alternative, handles pdf file upload in Next.js app router.\r\n\r\nBut first, where is the code that takes care of upload? To find that out, we first need to know where in the user interface on Documenso we upload pdf files.\r\n\r\n### Where is the file upload related code?\r\n\r\nWhen you visit [/documents](https://app.documenso.com/documents), you see a widget shown below that lets you   \r\nupload pdf files in the Documenso dashboard.\r\n\r\n![](https://cdn-images-1.medium.com/max/1600/1*pNvloo-Sx81qc6tAhAEFpA.png)\r\n\r\nSince Documenso uses Next.js app router and the url ends with `/documents`, we are looking for a folder named `documents` in the Documenso source code. You will find this in the [(dashboard)/documents/page.tsx](https://github.com/documenso/documenso/blob/main/apps/web/src/app/%28dashboard%29/documents/page.tsx), but straight away you don’t see anything that says “upload”.\r\n\r\n```js\r\nexport default async function DocumentsPage({ searchParams = {} }: DocumentsPageProps) {\r\n  await setupI18nSSR();\r\n\r\n  const { user } = await getRequiredServerComponentSession();\r\n\r\n  return (\r\n    <>\r\n      <UpcomingProfileClaimTeaser user={user} />\r\n      <DocumentsPageView searchParams={searchParams} />\r\n    </>\r\n  );\r\n}\r\n```\r\n\r\nThis means, we now have to search for “upload” in `DocumentsPageView` and `UpcomingProfileClaimTeaser`. Looking at the imports used in [documents/upcoming-profile-claim-teaser.tsx](https://github.com/documenso/documenso/blob/main/apps/web/src/app/%28dashboard%29/documents/upcoming-profile-claim-teaser.tsx)[,](https://github.com/documenso/documenso/blob/main/apps/web/src/app/%28dashboard%29/documents/upcoming-profile-claim-teaser.tsx%29,) there’s nothing related to “upload”, that means, it has to be in `DocumentsPageView`.\r\n\r\nIn the [documents-page-view.tsx](https://github.com/documenso/documenso/blob/main/apps/web/src/app/%28dashboard%29/documents/documents-page-view.tsx#L41)[,](https://github.com/documenso/documenso/blob/main/apps/web/src/app/%28dashboard%29/documents/documents-page-view.tsx#L41%29,) you will find this below shown import at [line 27](https://github.com/documenso/documenso/blob/main/apps/web/src/app/%28dashboard%29/documents/documents-page-view.tsx#L27).\r\n\r\n```js\r\nimport { UploadDocument } from './upload-document';\r\n```\r\n\r\nand this Component is the first in order in this [documents-page-view.tsx](https://github.com/documenso/documenso/blob/main/apps/web/src/app/%28dashboard%29/documents/documents-page-view.tsx#L102C5-L107C21), as shown below:\r\n\r\n```js\r\n<div className=\"mx-auto w-full max-w-screen-xl px-4 md:px-8\">\r\n      <UploadDocument team={currentTeam} />\r\n\r\n      <div className=\"mt-12 flex flex-wrap items-center justify-between gap-x-4 gap-y-8\">\r\n        <div className=\"flex flex-row items-center\">\r\n          {team && (\r\n```\r\n\r\nHence the reason why you see the Upload widget followed by list of documents that you may have uploaded before.\r\n\r\n![](https://cdn-images-1.medium.com/max/1600/1*P5EDROYdr-c70LQBuX9dcw.png)\r\n\r\n### DocumentDropzone\r\n\r\nYou will find this below code at line 133 in the [upload-document.tsx](https://github.com/documenso/documenso/blob/main/apps/web/src/app/%28dashboard%29/documents/upload-document.tsx#L133C8-L133C24)[,](https://github.com/documenso/documenso/blob/main/apps/web/src/app/%28dashboard%29/documents/upload-document.tsx#L133C8-L133C24%29,)  \r\nthat is imported from document-dropzone.tsx\r\n\r\n```js\r\n<DocumentDropzone\r\n className=\"h-[min(400px,50vh)]\"\r\n disabled={remaining.documents === 0 || !session?.user.emailVerified}\r\n disabledMessage={disabledMessage}\r\n onDrop={onFileDrop}\r\n onDropRejected={onFileDropRejected}\r\n/>\r\n```\r\n\r\nwe are interested in `onFileDrop` function. This function has [50+ lines of code](https://github.com/documenso/documenso/blob/main/apps/web/src/app/%28dashboard%29/documents/upload-document.tsx#L61-L120)[.](https://github.com/documenso/documenso/blob/main/apps/web/src/app/%28dashboard%29/documents/upload-document.tsx#L61-L120%29.) Let’s focus only on core functionality that does the upload.\r\n\r\n```js\r\nconst { type, data } = await putPdfFile(file);\r\n\r\nconst { id: documentDataId } = await createDocumentData({\r\n  type,\r\n  data,\r\n});\r\n\r\nconst { id } = await createDocument({\r\n  title: file.name,\r\n  documentDataId,\r\n  teamId: team?.id,\r\n});\r\n```\r\n\r\nThis code is picked from [onFileDrop function](https://github.com/documenso/documenso/blob/main/apps/web/src/app/%28dashboard%29/documents/upload-document.tsx#L65C7-L76C10)[.](https://github.com/documenso/documenso/blob/main/apps/web/src/app/%28dashboard%29/documents/upload-document.tsx#L65C7-L76C10%29.) `putPdfFile` is a function imported from [lib/universal/upload/put-file.ts](https://github.com/documenso/documenso/blob/main/packages/lib/universal/upload/put-file.ts#L22)\r\n\r\n#### putPdfFile\r\n\r\n```js\r\n/**\r\n * Uploads a document file to the appropriate storage location and creates\r\n * a document data record.\r\n */\r\nexport const putPdfFile = async (file: File) => {\r\n  const isEncryptedDocumentsAllowed = await getFlag('app_allow_encrypted_documents').catch(\r\n    () => false,\r\n  );\r\n\r\n  // This will prevent uploading encrypted PDFs or anything that can't be opened.\r\n  if (!isEncryptedDocumentsAllowed) {\r\n    await PDFDocument.load(await file.arrayBuffer()).catch((e) => {\r\n      console.error(`PDF upload parse error: ${e.message}`);\r\n\r\n      throw new AppError('INVALID_DOCUMENT_FILE');\r\n    });\r\n  }\r\n\r\n  if (!file.name.endsWith('.pdf')) {\r\n    file.name = `${file.name}.pdf`;\r\n  }\r\n\r\n  const { type, data } = await putFile(file);\r\n\r\n  return await createDocumentData({ type, data });\r\n};\r\n```\r\n\r\nThis function above has some checks against [uploading encrypted document](https://github.com/documenso/documenso/blob/main/packages/lib/universal/upload/put-file.ts#L28).\r\n\r\n#### putFile\r\n\r\nThis below code is picked from [upload/put-file.ts](https://github.com/documenso/documenso/blob/main/packages/lib/universal/upload/put-file.ts#L48)\r\n\r\n```js\r\n/**\r\n * Uploads a file to the appropriate storage location.\r\n */\r\nexport const putFile = async (file: File) => {\r\n  const NEXT_PUBLIC_UPLOAD_TRANSPORT = env('NEXT_PUBLIC_UPLOAD_TRANSPORT');\r\n\r\n  return await match(NEXT_PUBLIC_UPLOAD_TRANSPORT)\r\n    .with('s3', async () => putFileInS3(file))\r\n    .otherwise(async () => putFileInDatabase(file));\r\n};\r\n```\r\n\r\nso this function supports file uploads to either `S3` or upload to database. Interesting.\r\n\r\n# **About me:**\r\n\r\nHey, my name is Ramu Narasinga. I study large open-source projects and create content about their codebase architecture and best practices, sharing it through articles, videos.\r\n\r\nI am open to work on interesting projects. Send me an email at ramu.narasinga@gmail.com\r\n\r\nMy Github — [https://github.com/ramu-narasinga](https://github.com/ramu-narasinga)\r\n\r\nMy website — [https://ramunarasinga.com](https://ramunarasinga.com/)\r\n\r\nMy Youtube channel — [https://www.youtube.com/@thinkthroo](https://www.youtube.com/@thinkthroo)\r\n\r\nLearning platform — [https://thinkthroo.com](https://thinkthroo.com/)\r\n\r\nCodebase Architecture — [https://app.thinkthroo.com/architecture](https://app.thinkthroo.com/architecture)\r\n\r\nBest practices — [https://app.thinkthroo.com/best-practices](https://app.thinkthroo.com/best-practices)\r\n\r\nProduction-grade projects — [https://app.thinkthroo.com/production-grade-projects](https://app.thinkthroo.com/production-grade-projects)\r\n\r\n### References:\r\n\r\n1. [https://github.com/documenso/documenso/tree/main](https://github.com/documenso/documenso/tree/main)\r\n    \r\n2. [https://github.com/documenso/documenso/blob/main/apps/web/src/app/(dashboard)/documents/page.tsx](https://github.com/documenso/documenso/blob/main/apps/web/src/app/%28dashboard%29/documents/page.tsx)\r\n    \r\n3. [https://github.com/documenso/documenso/blob/main/apps/web/src/app/(dashboard)/documents/upcoming-profile-claim-teaser.tsx](https://github.com/documenso/documenso/blob/main/apps/web/src/app/%28dashboard%29/documents/upcoming-profile-claim-teaser.tsx)\r\n    \r\n4. [https://github.com/documenso/documenso/blob/main/apps/web/src/app/(dashboard)/documents/documents-page-view.tsx#L41](https://github.com/documenso/documenso/blob/main/apps/web/src/app/%28dashboard%29/documents/documents-page-view.tsx#L41)\r\n    \r\n5. [https://github.com/documenso/documenso/blob/main/apps/web/src/app/(dashboard)/documents/upload-document.tsx#L65](https://github.com/documenso/documenso/blob/main/apps/web/src/app/%28dashboard%29/documents/upload-document.tsx#L65)\r\n    \r\n6. [https://github.com/documenso/documenso/blob/main/packages/lib/universal/upload/put-file.ts#L22](https://github.com/documenso/documenso/blob/main/packages/lib/universal/upload/put-file.ts#L22)",
    "code": "var Component=(()=>{var h=Object.create;var o=Object.defineProperty;var p=Object.getOwnPropertyDescriptor;var m=Object.getOwnPropertyNames;var y=Object.getPrototypeOf,u=Object.prototype.hasOwnProperty;var b=(n,e)=>()=>(e||n((e={exports:{}}).exports,e),e.exports),f=(n,e)=>{for(var s in e)o(n,s,{get:e[s],enumerable:!0})},r=(n,e,s,a)=>{if(e&&typeof e==\"object\"||typeof e==\"function\")for(let c of m(e))!u.call(n,c)&&c!==s&&o(n,c,{get:()=>e[c],enumerable:!(a=p(e,c))||a.enumerable});return n};var g=(n,e,s)=>(s=n!=null?h(y(n)):{},r(e||!n||!n.__esModule?o(s,\"default\",{value:n,enumerable:!0}):s,n)),w=n=>r(o({},\"__esModule\",{value:!0}),n);var t=b((L,F)=>{F.exports=_jsx_runtime});var x={};f(x,{default:()=>d,frontmatter:()=>N});var l=g(t()),N={title:\"How Documenso, an open-source Docusign alternative, handles pdf file upload in\\xA0Next.js?\"};function i(n){let e={a:\"a\",br:\"br\",code:\"code\",div:\"div\",h1:\"h1\",h3:\"h3\",h4:\"h4\",img:\"img\",li:\"li\",ol:\"ol\",p:\"p\",pre:\"pre\",span:\"span\",strong:\"strong\",...n.components};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)(e.p,{children:[\"In this article, we analyse how \",(0,l.jsx)(e.a,{href:\"https://github.com/documenso/documenso/blob/main/apps/web/src/app/%28dashboard%29/documents/upload-document.tsx#L65\",children:\"Documenso\"}),(0,l.jsx)(e.a,{href:\"https://github.com/documenso/documenso/blob/main/apps/web/src/app/%28dashboard%29/documents/upload-document.tsx#L65%29,\",children:\",\"}),\" an open-source Docusign alternative, handles pdf file upload in Next.js app router.\"]}),`\n`,(0,l.jsx)(e.p,{children:\"But first, where is the code that takes care of upload? To find that out, we first need to know where in the user interface on Documenso we upload pdf files.\"}),`\n`,(0,l.jsx)(e.h3,{id:\"where-is-the-file-upload-relatedcode\",children:\"Where is the file upload related\\xA0code?\"}),`\n`,(0,l.jsxs)(e.p,{children:[\"When you visit \",(0,l.jsx)(e.a,{href:\"https://app.documenso.com/documents\",children:\"/documents\"}),\", you see a widget shown below that lets you\\xA0\",(0,l.jsx)(e.br,{}),`\n`,\"upload pdf files in the Documenso dashboard.\"]}),`\n`,(0,l.jsx)(e.p,{children:(0,l.jsx)(e.img,{src:\"https://cdn-images-1.medium.com/max/1600/1*pNvloo-Sx81qc6tAhAEFpA.png\",alt:\"\"})}),`\n`,(0,l.jsxs)(e.p,{children:[\"Since Documenso uses Next.js app router and the url ends with \",(0,l.jsx)(e.code,{children:\"/documents\"}),\", we are looking for a folder named \",(0,l.jsx)(e.code,{children:\"documents\"}),\" in the Documenso source code. You will find this in the \",(0,l.jsx)(e.a,{href:\"https://github.com/documenso/documenso/blob/main/apps/web/src/app/%28dashboard%29/documents/page.tsx\",children:\"(dashboard)/documents/page.tsx\"}),\", but straight away you don\\u2019t see anything that says \\u201Cupload\\u201D.\"]}),`\n`,(0,l.jsx)(e.div,{\"data-rehype-pretty-code-fragment\":\"\",children:(0,l.jsx)(e.pre,{\"data-language\":\"js\",\"data-theme\":\"default\",children:(0,l.jsxs)(e.code,{\"data-language\":\"js\",\"data-theme\":\"default\",children:[(0,l.jsxs)(e.span,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\"export\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\" default\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\" async\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\" function\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF\",fontWeight:\"bold\"},children:\" DocumentsPage\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\"({\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF\"},children:\" searchParams \"}),(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\"=\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\" {}\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\" }:\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF\",fontWeight:\"bold\"},children:\" DocumentsPageProps\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\")\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\" {\"})]}),`\n`,(0,l.jsxs)(e.span,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\"  await\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF\"},children:\" setupI18nSSR\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\"();\"})]}),`\n`,(0,l.jsx)(e.span,{className:\"line\",children:\" \"}),`\n`,(0,l.jsxs)(e.span,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\"  const\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\" {\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF\"},children:\" user \"}),(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\"}\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\" =\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\" await\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF\"},children:\" getRequiredServerComponentSession\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\"();\"})]}),`\n`,(0,l.jsx)(e.span,{className:\"line\",children:\" \"}),`\n`,(0,l.jsxs)(e.span,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\"  return\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\" (\"})]}),`\n`,(0,l.jsx)(e.span,{className:\"line\",children:(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\"    <>\"})}),`\n`,(0,l.jsxs)(e.span,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\"      <\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF\"},children:\"UpcomingProfileClaimTeaser user\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\"={\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF\"},children:\"user\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\"}\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\" />\"})]}),`\n`,(0,l.jsxs)(e.span,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\"      <\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF\"},children:\"DocumentsPageView searchParams\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\"={\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF\"},children:\"searchParams\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\"}\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\" />\"})]}),`\n`,(0,l.jsx)(e.span,{className:\"line\",children:(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\"    </>\"})}),`\n`,(0,l.jsx)(e.span,{className:\"line\",children:(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\"  );\"})}),`\n`,(0,l.jsx)(e.span,{className:\"line\",children:(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\"}\"})})]})})}),`\n`,(0,l.jsxs)(e.p,{children:[\"This means, we now have to search for \\u201Cupload\\u201D in \",(0,l.jsx)(e.code,{children:\"DocumentsPageView\"}),\" and \",(0,l.jsx)(e.code,{children:\"UpcomingProfileClaimTeaser\"}),\". Looking at the imports used in \",(0,l.jsx)(e.a,{href:\"https://github.com/documenso/documenso/blob/main/apps/web/src/app/%28dashboard%29/documents/upcoming-profile-claim-teaser.tsx\",children:\"documents/upcoming-profile-claim-teaser.tsx\"}),(0,l.jsx)(e.a,{href:\"https://github.com/documenso/documenso/blob/main/apps/web/src/app/%28dashboard%29/documents/upcoming-profile-claim-teaser.tsx%29,\",children:\",\"}),\" there\\u2019s nothing related to \\u201Cupload\\u201D, that means, it has to be in \",(0,l.jsx)(e.code,{children:\"DocumentsPageView\"}),\".\"]}),`\n`,(0,l.jsxs)(e.p,{children:[\"In the \",(0,l.jsx)(e.a,{href:\"https://github.com/documenso/documenso/blob/main/apps/web/src/app/%28dashboard%29/documents/documents-page-view.tsx#L41\",children:\"documents-page-view.tsx\"}),(0,l.jsx)(e.a,{href:\"https://github.com/documenso/documenso/blob/main/apps/web/src/app/%28dashboard%29/documents/documents-page-view.tsx#L41%29,\",children:\",\"}),\" you will find this below shown import at \",(0,l.jsx)(e.a,{href:\"https://github.com/documenso/documenso/blob/main/apps/web/src/app/%28dashboard%29/documents/documents-page-view.tsx#L27\",children:\"line 27\"}),\".\"]}),`\n`,(0,l.jsx)(e.div,{\"data-rehype-pretty-code-fragment\":\"\",children:(0,l.jsx)(e.pre,{\"data-language\":\"js\",\"data-theme\":\"default\",children:(0,l.jsx)(e.code,{\"data-language\":\"js\",\"data-theme\":\"default\",children:(0,l.jsxs)(e.span,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\"import\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\" {\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF\"},children:\" UploadDocument \"}),(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\"}\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\" from\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\" './upload-document'\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\";\"})]})})})}),`\n`,(0,l.jsxs)(e.p,{children:[\"and this Component is the first in order in this \",(0,l.jsx)(e.a,{href:\"https://github.com/documenso/documenso/blob/main/apps/web/src/app/%28dashboard%29/documents/documents-page-view.tsx#L102C5-L107C21\",children:\"documents-page-view.tsx\"}),\", as shown below:\"]}),`\n`,(0,l.jsx)(e.div,{\"data-rehype-pretty-code-fragment\":\"\",children:(0,l.jsx)(e.pre,{\"data-language\":\"js\",\"data-theme\":\"default\",children:(0,l.jsxs)(e.code,{\"data-language\":\"js\",\"data-theme\":\"default\",children:[(0,l.jsxs)(e.span,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\"<\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF\"},children:\"div className\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\"=\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:'\"mx-auto w-full max-w-screen-xl px-4 md:px-8\"'}),(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\">\"})]}),`\n`,(0,l.jsxs)(e.span,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\"      <\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF\"},children:\"UploadDocument team\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\"={\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF\"},children:\"currentTeam\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\"}\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\" />\"})]}),`\n`,(0,l.jsx)(e.span,{className:\"line\",children:\" \"}),`\n`,(0,l.jsxs)(e.span,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\"      <\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF\"},children:\"div className\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\"=\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:'\"mt-12 flex flex-wrap items-center justify-between gap-x-4 gap-y-8\"'}),(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\">\"})]}),`\n`,(0,l.jsxs)(e.span,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\"        <\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF\"},children:\"div className\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\"=\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:'\"flex flex-row items-center\"'}),(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\">\"})]}),`\n`,(0,l.jsxs)(e.span,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\"          {\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF\"},children:\"team \"}),(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\"&&\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\" (\"})]})]})})}),`\n`,(0,l.jsx)(e.p,{children:\"Hence the reason why you see the Upload widget followed by list of documents that you may have uploaded before.\"}),`\n`,(0,l.jsx)(e.p,{children:(0,l.jsx)(e.img,{src:\"https://cdn-images-1.medium.com/max/1600/1*P5EDROYdr-c70LQBuX9dcw.png\",alt:\"\"})}),`\n`,(0,l.jsx)(e.h3,{id:\"documentdropzone\",children:\"DocumentDropzone\"}),`\n`,(0,l.jsxs)(e.p,{children:[\"You will find this below code at line 133 in the \",(0,l.jsx)(e.a,{href:\"https://github.com/documenso/documenso/blob/main/apps/web/src/app/%28dashboard%29/documents/upload-document.tsx#L133C8-L133C24\",children:\"upload-document.tsx\"}),(0,l.jsx)(e.a,{href:\"https://github.com/documenso/documenso/blob/main/apps/web/src/app/%28dashboard%29/documents/upload-document.tsx#L133C8-L133C24%29,\",children:\",\"}),(0,l.jsx)(e.br,{}),`\n`,\"that is imported from document-dropzone.tsx\"]}),`\n`,(0,l.jsx)(e.div,{\"data-rehype-pretty-code-fragment\":\"\",children:(0,l.jsx)(e.pre,{\"data-language\":\"js\",\"data-theme\":\"default\",children:(0,l.jsxs)(e.code,{\"data-language\":\"js\",\"data-theme\":\"default\",children:[(0,l.jsxs)(e.span,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\"<\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF\"},children:\"DocumentDropzone\"})]}),`\n`,(0,l.jsxs)(e.span,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#FFF\"},children:\" className\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\"=\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:'\"h-[min(400px,50vh)]\"'})]}),`\n`,(0,l.jsxs)(e.span,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#FFF\"},children:\" disabled\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\"={\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF\"},children:\"remaining\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\".\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF\"},children:\"documents \"}),(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\"===\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\" 0\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\" ||\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\" !\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF\"},children:\"session\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\"?.\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF\"},children:\"user\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\".\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF\"},children:\"emailVerified\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\"}\"})]}),`\n`,(0,l.jsxs)(e.span,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#FFF\"},children:\" disabledMessage\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\"={\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF\"},children:\"disabledMessage\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\"}\"})]}),`\n`,(0,l.jsxs)(e.span,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#FFF\"},children:\" onDrop\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\"={\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF\"},children:\"onFileDrop\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\"}\"})]}),`\n`,(0,l.jsxs)(e.span,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#FFF\"},children:\" onDropRejected\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\"={\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF\"},children:\"onFileDropRejected\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\"}\"})]}),`\n`,(0,l.jsx)(e.span,{className:\"line\",children:(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\"/>\"})})]})})}),`\n`,(0,l.jsxs)(e.p,{children:[\"we are interested in \",(0,l.jsx)(e.code,{children:\"onFileDrop\"}),\" function. This function has \",(0,l.jsx)(e.a,{href:\"https://github.com/documenso/documenso/blob/main/apps/web/src/app/%28dashboard%29/documents/upload-document.tsx#L61-L120\",children:\"50+ lines of code\"}),(0,l.jsx)(e.a,{href:\"https://github.com/documenso/documenso/blob/main/apps/web/src/app/%28dashboard%29/documents/upload-document.tsx#L61-L120%29.\",children:\".\"}),\" Let\\u2019s focus only on core functionality that does the upload.\"]}),`\n`,(0,l.jsx)(e.div,{\"data-rehype-pretty-code-fragment\":\"\",children:(0,l.jsx)(e.pre,{\"data-language\":\"js\",\"data-theme\":\"default\",children:(0,l.jsxs)(e.code,{\"data-language\":\"js\",\"data-theme\":\"default\",children:[(0,l.jsxs)(e.span,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\"const\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\" {\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF\"},children:\" type\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\",\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF\"},children:\" data \"}),(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\"}\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\" =\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\" await\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF\"},children:\" putPdfFile\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\"(\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF\"},children:\"file\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\");\"})]}),`\n`,(0,l.jsx)(e.span,{className:\"line\",children:\" \"}),`\n`,(0,l.jsxs)(e.span,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\"const\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\" {\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF\"},children:\" id\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\":\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF\"},children:\" documentDataId \"}),(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\"}\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\" =\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\" await\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF\"},children:\" createDocumentData\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\"({\"})]}),`\n`,(0,l.jsxs)(e.span,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#FFF\"},children:\"  type\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\",\"})]}),`\n`,(0,l.jsxs)(e.span,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#FFF\"},children:\"  data\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\",\"})]}),`\n`,(0,l.jsx)(e.span,{className:\"line\",children:(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\"});\"})}),`\n`,(0,l.jsx)(e.span,{className:\"line\",children:\" \"}),`\n`,(0,l.jsxs)(e.span,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\"const\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\" {\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF\"},children:\" id \"}),(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\"}\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\" =\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\" await\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF\"},children:\" createDocument\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\"({\"})]}),`\n`,(0,l.jsxs)(e.span,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#FFF\"},children:\"  title\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\":\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF\"},children:\" file\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\".\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF\"},children:\"name\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\",\"})]}),`\n`,(0,l.jsxs)(e.span,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#FFF\"},children:\"  documentDataId\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\",\"})]}),`\n`,(0,l.jsxs)(e.span,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#FFF\"},children:\"  teamId\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\":\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF\"},children:\" team\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\"?.\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF\"},children:\"id\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\",\"})]}),`\n`,(0,l.jsx)(e.span,{className:\"line\",children:(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\"});\"})})]})})}),`\n`,(0,l.jsxs)(e.p,{children:[\"This code is picked from \",(0,l.jsx)(e.a,{href:\"https://github.com/documenso/documenso/blob/main/apps/web/src/app/%28dashboard%29/documents/upload-document.tsx#L65C7-L76C10\",children:\"onFileDrop function\"}),(0,l.jsx)(e.a,{href:\"https://github.com/documenso/documenso/blob/main/apps/web/src/app/%28dashboard%29/documents/upload-document.tsx#L65C7-L76C10%29.\",children:\".\"}),\" \",(0,l.jsx)(e.code,{children:\"putPdfFile\"}),\" is a function imported from \",(0,l.jsx)(e.a,{href:\"https://github.com/documenso/documenso/blob/main/packages/lib/universal/upload/put-file.ts#L22\",children:\"lib/universal/upload/put-file.ts\"})]}),`\n`,(0,l.jsx)(e.h4,{id:\"putpdffile\",children:\"putPdfFile\"}),`\n`,(0,l.jsx)(e.div,{\"data-rehype-pretty-code-fragment\":\"\",children:(0,l.jsx)(e.pre,{\"data-language\":\"js\",\"data-theme\":\"default\",children:(0,l.jsxs)(e.code,{\"data-language\":\"js\",\"data-theme\":\"default\",children:[(0,l.jsx)(e.span,{className:\"line\",children:(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\"/**\"})}),`\n`,(0,l.jsx)(e.span,{className:\"line\",children:(0,l.jsx)(e.span,{style:{color:\"#FFF4\"},children:\" * Uploads a document file to the appropriate storage location and creates\"})}),`\n`,(0,l.jsx)(e.span,{className:\"line\",children:(0,l.jsx)(e.span,{style:{color:\"#FFF4\"},children:\" * a document data record.\"})}),`\n`,(0,l.jsx)(e.span,{className:\"line\",children:(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\" */\"})}),`\n`,(0,l.jsxs)(e.span,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\"export\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\" const\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF\",fontWeight:\"bold\"},children:\" putPdfFile\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\" =\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\" async\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\" (\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF\"},children:\"file\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\":\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF\",fontWeight:\"bold\"},children:\" File\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\")\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\" =>\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\" {\"})]}),`\n`,(0,l.jsxs)(e.span,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\"  const\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF\"},children:\" isEncryptedDocumentsAllowed \"}),(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\"=\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\" await\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF\"},children:\" getFlag\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\"(\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\"'app_allow_encrypted_documents'\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\").\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF\"},children:\"catch\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\"(\"})]}),`\n`,(0,l.jsxs)(e.span,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\"    ()\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\" =>\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\" false,\"})]}),`\n`,(0,l.jsx)(e.span,{className:\"line\",children:(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\"  );\"})}),`\n`,(0,l.jsx)(e.span,{className:\"line\",children:\" \"}),`\n`,(0,l.jsxs)(e.span,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\"  //\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF4\"},children:\" This will prevent uploading encrypted PDFs or anything that can't be opened.\"})]}),`\n`,(0,l.jsxs)(e.span,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\"  if\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\" (!\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF\"},children:\"isEncryptedDocumentsAllowed\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\")\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\" {\"})]}),`\n`,(0,l.jsxs)(e.span,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\"    await\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF\"},children:\" PDFDocument\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\".\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF\"},children:\"load\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\"(await\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF\"},children:\" file\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\".\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF\"},children:\"arrayBuffer\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\"()).\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF\"},children:\"catch\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\"((\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF\"},children:\"e\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\")\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\" =>\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\" {\"})]}),`\n`,(0,l.jsxs)(e.span,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#FFF\"},children:\"      console\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\".\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF\"},children:\"error\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\"(\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\"`PDF upload parse error: ${\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF\"},children:\"e\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\".\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF\"},children:\"message\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\"}`\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\");\"})]}),`\n`,(0,l.jsx)(e.span,{className:\"line\",children:\" \"}),`\n`,(0,l.jsxs)(e.span,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\"      throw\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\" new\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF\"},children:\" AppError\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\"(\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\"'INVALID_DOCUMENT_FILE'\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\");\"})]}),`\n`,(0,l.jsx)(e.span,{className:\"line\",children:(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\"    });\"})}),`\n`,(0,l.jsx)(e.span,{className:\"line\",children:(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\"  }\"})}),`\n`,(0,l.jsx)(e.span,{className:\"line\",children:\" \"}),`\n`,(0,l.jsxs)(e.span,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\"  if\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\" (!\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF\"},children:\"file\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\".\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF\"},children:\"name\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\".\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF\"},children:\"endsWith\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\"(\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\"'.pdf'\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\"))\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\" {\"})]}),`\n`,(0,l.jsxs)(e.span,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#FFF\"},children:\"    file\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\".\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF\"},children:\"name \"}),(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\"=\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\" `${\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF\"},children:\"file\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\".\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF\"},children:\"name\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\"}.pdf`\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\";\"})]}),`\n`,(0,l.jsx)(e.span,{className:\"line\",children:(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\"  }\"})}),`\n`,(0,l.jsx)(e.span,{className:\"line\",children:\" \"}),`\n`,(0,l.jsxs)(e.span,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\"  const\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\" {\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF\"},children:\" type\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\",\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF\"},children:\" data \"}),(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\"}\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\" =\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\" await\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF\"},children:\" putFile\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\"(\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF\"},children:\"file\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\");\"})]}),`\n`,(0,l.jsx)(e.span,{className:\"line\",children:\" \"}),`\n`,(0,l.jsxs)(e.span,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\"  return\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\" await\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF\"},children:\" createDocumentData\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\"({\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF\"},children:\" type\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\",\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF\"},children:\" data \"}),(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\"});\"})]}),`\n`,(0,l.jsx)(e.span,{className:\"line\",children:(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\"};\"})})]})})}),`\n`,(0,l.jsxs)(e.p,{children:[\"This function above has some checks against \",(0,l.jsx)(e.a,{href:\"https://github.com/documenso/documenso/blob/main/packages/lib/universal/upload/put-file.ts#L28\",children:\"uploading encrypted document\"}),\".\"]}),`\n`,(0,l.jsx)(e.h4,{id:\"putfile\",children:\"putFile\"}),`\n`,(0,l.jsxs)(e.p,{children:[\"This below code is picked from \",(0,l.jsx)(e.a,{href:\"https://github.com/documenso/documenso/blob/main/packages/lib/universal/upload/put-file.ts#L48\",children:\"upload/put-file.ts\"})]}),`\n`,(0,l.jsx)(e.div,{\"data-rehype-pretty-code-fragment\":\"\",children:(0,l.jsx)(e.pre,{\"data-language\":\"js\",\"data-theme\":\"default\",children:(0,l.jsxs)(e.code,{\"data-language\":\"js\",\"data-theme\":\"default\",children:[(0,l.jsx)(e.span,{className:\"line\",children:(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\"/**\"})}),`\n`,(0,l.jsx)(e.span,{className:\"line\",children:(0,l.jsx)(e.span,{style:{color:\"#FFF4\"},children:\" * Uploads a file to the appropriate storage location.\"})}),`\n`,(0,l.jsx)(e.span,{className:\"line\",children:(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\" */\"})}),`\n`,(0,l.jsxs)(e.span,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\"export\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\" const\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF\",fontWeight:\"bold\"},children:\" putFile\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\" =\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\" async\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\" (\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF\"},children:\"file\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\":\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF\",fontWeight:\"bold\"},children:\" File\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\")\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\" =>\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\" {\"})]}),`\n`,(0,l.jsxs)(e.span,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\"  const\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF\"},children:\" NEXT_PUBLIC_UPLOAD_TRANSPORT \"}),(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\"=\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF\"},children:\" env\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\"(\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\"'NEXT_PUBLIC_UPLOAD_TRANSPORT'\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\");\"})]}),`\n`,(0,l.jsx)(e.span,{className:\"line\",children:\" \"}),`\n`,(0,l.jsxs)(e.span,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\"  return\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\" await\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF\"},children:\" match\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\"(\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF\"},children:\"NEXT_PUBLIC_UPLOAD_TRANSPORT\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\")\"})]}),`\n`,(0,l.jsxs)(e.span,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\"    .\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF\"},children:\"with\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\"(\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\"'s3'\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\",\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\" async\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\" ()\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\" =>\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF\"},children:\" putFileInS3\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\"(\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF\"},children:\"file\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\"))\"})]}),`\n`,(0,l.jsxs)(e.span,{className:\"line\",children:[(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\"    .\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF\"},children:\"otherwise\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\"(async\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\" ()\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\" =>\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF\"},children:\" putFileInDatabase\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\"(\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF\"},children:\"file\"}),(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\"));\"})]}),`\n`,(0,l.jsx)(e.span,{className:\"line\",children:(0,l.jsx)(e.span,{style:{color:\"#FFF8\"},children:\"};\"})})]})})}),`\n`,(0,l.jsxs)(e.p,{children:[\"so this function supports file uploads to either \",(0,l.jsx)(e.code,{children:\"S3\"}),\" or upload to database. Interesting.\"]}),`\n`,(0,l.jsx)(e.h1,{id:\"about-me\",children:(0,l.jsx)(e.strong,{children:\"About me:\"})}),`\n`,(0,l.jsx)(e.p,{children:\"Hey, my name is Ramu Narasinga. I study large open-source projects and create content about their codebase architecture and best practices, sharing it through articles, videos.\"}),`\n`,(0,l.jsxs)(e.p,{children:[\"I am open to work on interesting projects. Send me an email at \",(0,l.jsx)(e.a,{href:\"mailto:ramu.narasinga@gmail.com\",children:\"ramu.narasinga@gmail.com\"})]}),`\n`,(0,l.jsxs)(e.p,{children:[\"My Github \\u2014 \",(0,l.jsx)(e.a,{href:\"https://github.com/ramu-narasinga\",children:\"https://github.com/ramu-narasinga\"})]}),`\n`,(0,l.jsxs)(e.p,{children:[\"My website \\u2014 \",(0,l.jsx)(e.a,{href:\"https://ramunarasinga.com/\",children:\"https://ramunarasinga.com\"})]}),`\n`,(0,l.jsxs)(e.p,{children:[\"My Youtube channel \\u2014 \",(0,l.jsx)(e.a,{href:\"https://www.youtube.com/@thinkthroo\",children:\"https://www.youtube.com/@thinkthroo\"})]}),`\n`,(0,l.jsxs)(e.p,{children:[\"Learning platform \\u2014 \",(0,l.jsx)(e.a,{href:\"https://thinkthroo.com/\",children:\"https://thinkthroo.com\"})]}),`\n`,(0,l.jsxs)(e.p,{children:[\"Codebase Architecture \\u2014 \",(0,l.jsx)(e.a,{href:\"https://app.thinkthroo.com/architecture\",children:\"https://app.thinkthroo.com/architecture\"})]}),`\n`,(0,l.jsxs)(e.p,{children:[\"Best practices \\u2014 \",(0,l.jsx)(e.a,{href:\"https://app.thinkthroo.com/best-practices\",children:\"https://app.thinkthroo.com/best-practices\"})]}),`\n`,(0,l.jsxs)(e.p,{children:[\"Production-grade projects \\u2014 \",(0,l.jsx)(e.a,{href:\"https://app.thinkthroo.com/production-grade-projects\",children:\"https://app.thinkthroo.com/production-grade-projects\"})]}),`\n`,(0,l.jsx)(e.h3,{id:\"references\",children:\"References:\"}),`\n`,(0,l.jsxs)(e.ol,{children:[`\n`,(0,l.jsxs)(e.li,{children:[`\n`,(0,l.jsx)(e.p,{children:(0,l.jsx)(e.a,{href:\"https://github.com/documenso/documenso/tree/main\",children:\"https://github.com/documenso/documenso/tree/main\"})}),`\n`]}),`\n`,(0,l.jsxs)(e.li,{children:[`\n`,(0,l.jsx)(e.p,{children:(0,l.jsx)(e.a,{href:\"https://github.com/documenso/documenso/blob/main/apps/web/src/app/%28dashboard%29/documents/page.tsx\",children:\"https://github.com/documenso/documenso/blob/main/apps/web/src/app/(dashboard)/documents/page.tsx\"})}),`\n`]}),`\n`,(0,l.jsxs)(e.li,{children:[`\n`,(0,l.jsx)(e.p,{children:(0,l.jsx)(e.a,{href:\"https://github.com/documenso/documenso/blob/main/apps/web/src/app/%28dashboard%29/documents/upcoming-profile-claim-teaser.tsx\",children:\"https://github.com/documenso/documenso/blob/main/apps/web/src/app/(dashboard)/documents/upcoming-profile-claim-teaser.tsx\"})}),`\n`]}),`\n`,(0,l.jsxs)(e.li,{children:[`\n`,(0,l.jsx)(e.p,{children:(0,l.jsx)(e.a,{href:\"https://github.com/documenso/documenso/blob/main/apps/web/src/app/%28dashboard%29/documents/documents-page-view.tsx#L41\",children:\"https://github.com/documenso/documenso/blob/main/apps/web/src/app/(dashboard)/documents/documents-page-view.tsx#L41\"})}),`\n`]}),`\n`,(0,l.jsxs)(e.li,{children:[`\n`,(0,l.jsx)(e.p,{children:(0,l.jsx)(e.a,{href:\"https://github.com/documenso/documenso/blob/main/apps/web/src/app/%28dashboard%29/documents/upload-document.tsx#L65\",children:\"https://github.com/documenso/documenso/blob/main/apps/web/src/app/(dashboard)/documents/upload-document.tsx#L65\"})}),`\n`]}),`\n`,(0,l.jsxs)(e.li,{children:[`\n`,(0,l.jsx)(e.p,{children:(0,l.jsx)(e.a,{href:\"https://github.com/documenso/documenso/blob/main/packages/lib/universal/upload/put-file.ts#L22\",children:\"https://github.com/documenso/documenso/blob/main/packages/lib/universal/upload/put-file.ts#L22\"})}),`\n`]}),`\n`]})]})}function d(n={}){let{wrapper:e}=n.components||{};return e?(0,l.jsx)(e,{...n,children:(0,l.jsx)(i,{...n})}):i(n)}return w(x);})();\n;return Component;"
  },
  "_id": "blog/pdf-file-upload-in-documenso.mdx",
  "_raw": {
    "sourceFilePath": "blog/pdf-file-upload-in-documenso.mdx",
    "sourceFileName": "pdf-file-upload-in-documenso.mdx",
    "sourceFileDir": "blog",
    "contentType": "mdx",
    "flattenedPath": "blog/pdf-file-upload-in-documenso"
  },
  "type": "Doc",
  "slug": "/blog/pdf-file-upload-in-documenso",
  "slugAsParams": "pdf-file-upload-in-documenso"
}