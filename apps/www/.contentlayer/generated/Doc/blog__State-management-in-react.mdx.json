{
  "title": "State management in react-scan codebase.",
  "published": false,
  "featured": false,
  "component": false,
  "toc": true,
  "body": {
    "raw": "\nIn this article, we review how the store is managed in react-scan source code. The below code is picked from [packages/scan/core/src/index.ts](https://github.com/aidenybai/react-scan/blob/main/packages/scan/src/core/index.ts#L260).\n\n```plaintext\nexport const Store: StoreType = {\n  wasDetailsOpen: signal(true),\n  isInIframe: signal(\n    typeof window !== 'undefined' && window.self !== window.top,\n  ),\n  inspectState: signal<States>({\n    kind: 'uninitialized',\n  }),\n  monitor: signal<Monitor | null>(null),\n  fiberRoots: new Set<Fiber>(),\n  reportData: new Map<number, RenderData>(),\n  legacyReportData: new Map<string, RenderData>(),\n  lastReportTime: signal(0),\n};\n```\n\nYou will find Set, Map but I don’t know what signal here is. Let’s find out.\n\nsignal is imported from preact as shown below\n\n```plaintext\nimport { type Signal, signal } from '@preact/signals';\n```\n\n### Signals in Preact\n\nSignals are reactive primitives for managing application state.\n\nWhat makes Signals unique is that state changes automatically update components and UI in the most efficient way possible. Automatic state binding and dependency tracking allows Signals to provide excellent ergonomics and productivity while eliminating the most common state management footguns.\n\nSignals are effective in applications of any size, with ergonomics that speed up the development of small apps, and performance characteristics that ensure apps of any size are fast by default.\n\nRead more about [Signals](https://preactjs.com/guide/v10/signals/).\n\n### How this state is used in react-scan?\n\nI [searched for signals](https://github.com/search?q=repo%3Aaidenybai%2Freact-scan%20Store&type=code) and found that it is used in 30 files.\n\n![](https://cdn-images-1.medium.com/max/1200/1*AfCQH8COP5KAQwFMps8PyQ.png)\n\nI have picked some instances where this state is used.\n\n#### [core/monitor/performance.ts](https://github.com/aidenybai/react-scan/blob/244f7c4741083944268753f299115703005f47e6/packages/scan/src/core/monitor/performance.ts#L177)\n\n```plaintext\n// todo: update monitoring api to expose filters for component names\nexport function initPerformanceMonitoring(options?: Partial<PathFilters>) {\n  const filters = { ...DEFAULT_FILTERS, ...options };\n  const monitor = Store.monitor.value;\n  if (!monitor) return;\n```\n\n#### [scan/web/views/index.tsx](https://github.com/aidenybai/react-scan/blob/244f7c4741083944268753f299115703005f47e6/packages/scan/src/web/views/index.tsx#L13)\n\n```plaintext\nexport const Content = () => {\n  const isInspecting = useComputed(\n    () => Store.inspectState.value.kind === 'inspecting',\n  );\n\n  return }\n    <div\n```\n\n#### [scan/src/web/widget/resize-handle.tsx](https://github.com/aidenybai/react-scan/blob/244f7c4741083944268753f299115703005f47e6/packages/scan/src/web/widget/resize-handle.tsx#L54)\n\n```plaintext\n const updateVisibility = () => {\n      const isFocused = Store.inspectState.value.kind === 'focused';\n      const shouldShow = signalWidgetViews.value.view !== 'none';\n      const isVisible =\n        (isFocused || shouldShow) &&\n        getHandleVisibility(\n          position,\n          signalWidget.value.corner,\n          signalWidget.value.dimensions.isFullWidth,\n          signalWidget.value.dimensions.isFullHeight,\n        );\n```\n\n### About me:\n\nHey, my name is [Ramu Narasinga](https://ramunarasinga.com). I study large open-source projects and create content about their codebase architecture and best practices, sharing it through articles, videos.\n\n***I am open to work on interesting projects. Send me an email at ramu.narasinga@gmail.com***\n\nMy Github —  [https://github.com/ramu-narasinga](https://github.com/ramu-narasinga)\n\nMy website —  [https://ramunarasinga.com](https://ramunarasinga.com/)\n\nMy Youtube channel —  [https://www.youtube.com/@thinkthroo](https://www.youtube.com/@thinkthroo)\n\nLearning platform —  [https://thinkthroo.com](https://thinkthroo.com/)\n\nCodebase Architecture —  [https://app.thinkthroo.com/architecture](https://app.thinkthroo.com/architecture)\n\nBest practices —  [https://app.thinkthroo.com/best-practices](https://app.thinkthroo.com/best-practices)\n\nProduction-grade projects —  [https://app.thinkthroo.com/production-grade-projects](https://app.thinkthroo.com/production-grade-projects)\n\n### References:\n\n1. [https://github.com/aidenybai/react-scan/blob/main/packages/scan/src/core/index.ts#L260](https://github.com/aidenybai/react-scan/blob/main/packages/scan/src/core/index.ts#L260)\n    \n2. [https://github.com/search?q=repo%3Aaidenybai%2Freact-scan%20Store&type=code](https://github.com/search?q=repo%3Aaidenybai%2Freact-scan%20Store&type=code)\n    \n3. [https://github.com/aidenybai/react-scan?tab=readme-ov-file#api-reference](https://github.com/aidenybai/react-scan?tab=readme-ov-file#api-reference)\n    \n4. [https://preactjs.com/guide/v10/signals/](https://preactjs.com/guide/v10/signals/)",
    "code": "var Component=(()=>{var p=Object.create;var s=Object.defineProperty;var m=Object.getOwnPropertyDescriptor;var g=Object.getOwnPropertyNames;var u=Object.getPrototypeOf,f=Object.prototype.hasOwnProperty;var b=(a,e)=>()=>(e||a((e={exports:{}}).exports,e),e.exports),w=(a,e)=>{for(var i in e)s(a,i,{get:e[i],enumerable:!0})},r=(a,e,i,c)=>{if(e&&typeof e==\"object\"||typeof e==\"function\")for(let t of g(e))!f.call(a,t)&&t!==i&&s(a,t,{get:()=>e[t],enumerable:!(c=m(e,t))||c.enumerable});return a};var y=(a,e,i)=>(i=a!=null?p(u(a)):{},r(e||!a||!a.__esModule?s(i,\"default\",{value:a,enumerable:!0}):i,a)),N=a=>r(s({},\"__esModule\",{value:!0}),a);var d=b((S,l)=>{l.exports=_jsx_runtime});var v={};w(v,{default:()=>o,frontmatter:()=>x});var n=y(d()),x={title:\"State management in react-scan codebase.\"};function h(a){let e={a:\"a\",code:\"code\",div:\"div\",em:\"em\",h3:\"h3\",h4:\"h4\",img:\"img\",li:\"li\",ol:\"ol\",p:\"p\",pre:\"pre\",span:\"span\",strong:\"strong\",...a.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(e.p,{children:[\"In this article, we review how the store is managed in react-scan source code. The below code is picked from \",(0,n.jsx)(e.a,{href:\"https://github.com/aidenybai/react-scan/blob/main/packages/scan/src/core/index.ts#L260\",children:\"packages/scan/core/src/index.ts\"}),\".\"]}),`\n`,(0,n.jsx)(e.div,{\"data-rehype-pretty-code-fragment\":\"\",children:(0,n.jsx)(e.pre,{\"data-language\":\"plaintext\",\"data-theme\":\"default\",children:(0,n.jsxs)(e.code,{\"data-language\":\"plaintext\",\"data-theme\":\"default\",children:[(0,n.jsx)(e.span,{className:\"line\",children:(0,n.jsx)(e.span,{children:\"export const Store: StoreType = {\"})}),`\n`,(0,n.jsx)(e.span,{className:\"line\",children:(0,n.jsx)(e.span,{children:\"  wasDetailsOpen: signal(true),\"})}),`\n`,(0,n.jsx)(e.span,{className:\"line\",children:(0,n.jsx)(e.span,{children:\"  isInIframe: signal(\"})}),`\n`,(0,n.jsx)(e.span,{className:\"line\",children:(0,n.jsx)(e.span,{children:\"    typeof window !== 'undefined' && window.self !== window.top,\"})}),`\n`,(0,n.jsx)(e.span,{className:\"line\",children:(0,n.jsx)(e.span,{children:\"  ),\"})}),`\n`,(0,n.jsx)(e.span,{className:\"line\",children:(0,n.jsx)(e.span,{children:\"  inspectState: signal<States>({\"})}),`\n`,(0,n.jsx)(e.span,{className:\"line\",children:(0,n.jsx)(e.span,{children:\"    kind: 'uninitialized',\"})}),`\n`,(0,n.jsx)(e.span,{className:\"line\",children:(0,n.jsx)(e.span,{children:\"  }),\"})}),`\n`,(0,n.jsx)(e.span,{className:\"line\",children:(0,n.jsx)(e.span,{children:\"  monitor: signal<Monitor | null>(null),\"})}),`\n`,(0,n.jsx)(e.span,{className:\"line\",children:(0,n.jsx)(e.span,{children:\"  fiberRoots: new Set<Fiber>(),\"})}),`\n`,(0,n.jsx)(e.span,{className:\"line\",children:(0,n.jsx)(e.span,{children:\"  reportData: new Map<number, RenderData>(),\"})}),`\n`,(0,n.jsx)(e.span,{className:\"line\",children:(0,n.jsx)(e.span,{children:\"  legacyReportData: new Map<string, RenderData>(),\"})}),`\n`,(0,n.jsx)(e.span,{className:\"line\",children:(0,n.jsx)(e.span,{children:\"  lastReportTime: signal(0),\"})}),`\n`,(0,n.jsx)(e.span,{className:\"line\",children:(0,n.jsx)(e.span,{children:\"};\"})})]})})}),`\n`,(0,n.jsx)(e.p,{children:\"You will find Set, Map but I don\\u2019t know what signal here is. Let\\u2019s find out.\"}),`\n`,(0,n.jsx)(e.p,{children:\"signal is imported from preact as shown below\"}),`\n`,(0,n.jsx)(e.div,{\"data-rehype-pretty-code-fragment\":\"\",children:(0,n.jsx)(e.pre,{\"data-language\":\"plaintext\",\"data-theme\":\"default\",children:(0,n.jsx)(e.code,{\"data-language\":\"plaintext\",\"data-theme\":\"default\",children:(0,n.jsx)(e.span,{className:\"line\",children:(0,n.jsx)(e.span,{children:\"import { type Signal, signal } from '@preact/signals';\"})})})})}),`\n`,(0,n.jsx)(e.h3,{id:\"signals-inpreact\",children:\"Signals in\\xA0Preact\"}),`\n`,(0,n.jsx)(e.p,{children:\"Signals are reactive primitives for managing application state.\"}),`\n`,(0,n.jsx)(e.p,{children:\"What makes Signals unique is that state changes automatically update components and UI in the most efficient way possible. Automatic state binding and dependency tracking allows Signals to provide excellent ergonomics and productivity while eliminating the most common state management footguns.\"}),`\n`,(0,n.jsx)(e.p,{children:\"Signals are effective in applications of any size, with ergonomics that speed up the development of small apps, and performance characteristics that ensure apps of any size are fast by default.\"}),`\n`,(0,n.jsxs)(e.p,{children:[\"Read more about \",(0,n.jsx)(e.a,{href:\"https://preactjs.com/guide/v10/signals/\",children:\"Signals\"}),\".\"]}),`\n`,(0,n.jsx)(e.h3,{id:\"how-this-state-is-used-in-react-scan\",children:\"How this state is used in react-scan?\"}),`\n`,(0,n.jsxs)(e.p,{children:[\"I \",(0,n.jsx)(e.a,{href:\"https://github.com/search?q=repo%3Aaidenybai%2Freact-scan%20Store&type=code\",children:\"searched for signals\"}),\" and found that it is used in 30 files.\"]}),`\n`,(0,n.jsx)(e.p,{children:(0,n.jsx)(e.img,{src:\"https://cdn-images-1.medium.com/max/1200/1*AfCQH8COP5KAQwFMps8PyQ.png\",alt:\"\"})}),`\n`,(0,n.jsx)(e.p,{children:\"I have picked some instances where this state is used.\"}),`\n`,(0,n.jsx)(e.h4,{id:\"coremonitorperformancets\",children:(0,n.jsx)(e.a,{href:\"https://github.com/aidenybai/react-scan/blob/244f7c4741083944268753f299115703005f47e6/packages/scan/src/core/monitor/performance.ts#L177\",children:\"core/monitor/performance.ts\"})}),`\n`,(0,n.jsx)(e.div,{\"data-rehype-pretty-code-fragment\":\"\",children:(0,n.jsx)(e.pre,{\"data-language\":\"plaintext\",\"data-theme\":\"default\",children:(0,n.jsxs)(e.code,{\"data-language\":\"plaintext\",\"data-theme\":\"default\",children:[(0,n.jsx)(e.span,{className:\"line\",children:(0,n.jsx)(e.span,{children:\"// todo: update monitoring api to expose filters for component names\"})}),`\n`,(0,n.jsx)(e.span,{className:\"line\",children:(0,n.jsx)(e.span,{children:\"export function initPerformanceMonitoring(options?: Partial<PathFilters>) {\"})}),`\n`,(0,n.jsx)(e.span,{className:\"line\",children:(0,n.jsx)(e.span,{children:\"  const filters = { ...DEFAULT_FILTERS, ...options };\"})}),`\n`,(0,n.jsx)(e.span,{className:\"line\",children:(0,n.jsx)(e.span,{children:\"  const monitor = Store.monitor.value;\"})}),`\n`,(0,n.jsx)(e.span,{className:\"line\",children:(0,n.jsx)(e.span,{children:\"  if (!monitor) return;\"})})]})})}),`\n`,(0,n.jsx)(e.h4,{id:\"scanwebviewsindextsx\",children:(0,n.jsx)(e.a,{href:\"https://github.com/aidenybai/react-scan/blob/244f7c4741083944268753f299115703005f47e6/packages/scan/src/web/views/index.tsx#L13\",children:\"scan/web/views/index.tsx\"})}),`\n`,(0,n.jsx)(e.div,{\"data-rehype-pretty-code-fragment\":\"\",children:(0,n.jsx)(e.pre,{\"data-language\":\"plaintext\",\"data-theme\":\"default\",children:(0,n.jsxs)(e.code,{\"data-language\":\"plaintext\",\"data-theme\":\"default\",children:[(0,n.jsx)(e.span,{className:\"line\",children:(0,n.jsx)(e.span,{children:\"export const Content = () => {\"})}),`\n`,(0,n.jsx)(e.span,{className:\"line\",children:(0,n.jsx)(e.span,{children:\"  const isInspecting = useComputed(\"})}),`\n`,(0,n.jsx)(e.span,{className:\"line\",children:(0,n.jsx)(e.span,{children:\"    () => Store.inspectState.value.kind === 'inspecting',\"})}),`\n`,(0,n.jsx)(e.span,{className:\"line\",children:(0,n.jsx)(e.span,{children:\"  );\"})}),`\n`,(0,n.jsx)(e.span,{className:\"line\",children:(0,n.jsx)(e.span,{})}),`\n`,(0,n.jsx)(e.span,{className:\"line\",children:(0,n.jsx)(e.span,{children:\"  return }\"})}),`\n`,(0,n.jsx)(e.span,{className:\"line\",children:(0,n.jsx)(e.span,{children:\"    <div\"})})]})})}),`\n`,(0,n.jsx)(e.h4,{id:\"scansrcwebwidgetresize-handletsx\",children:(0,n.jsx)(e.a,{href:\"https://github.com/aidenybai/react-scan/blob/244f7c4741083944268753f299115703005f47e6/packages/scan/src/web/widget/resize-handle.tsx#L54\",children:\"scan/src/web/widget/resize-handle.tsx\"})}),`\n`,(0,n.jsx)(e.div,{\"data-rehype-pretty-code-fragment\":\"\",children:(0,n.jsx)(e.pre,{\"data-language\":\"plaintext\",\"data-theme\":\"default\",children:(0,n.jsxs)(e.code,{\"data-language\":\"plaintext\",\"data-theme\":\"default\",children:[(0,n.jsx)(e.span,{className:\"line\",children:(0,n.jsx)(e.span,{children:\" const updateVisibility = () => {\"})}),`\n`,(0,n.jsx)(e.span,{className:\"line\",children:(0,n.jsx)(e.span,{children:\"      const isFocused = Store.inspectState.value.kind === 'focused';\"})}),`\n`,(0,n.jsx)(e.span,{className:\"line\",children:(0,n.jsx)(e.span,{children:\"      const shouldShow = signalWidgetViews.value.view !== 'none';\"})}),`\n`,(0,n.jsx)(e.span,{className:\"line\",children:(0,n.jsx)(e.span,{children:\"      const isVisible =\"})}),`\n`,(0,n.jsx)(e.span,{className:\"line\",children:(0,n.jsx)(e.span,{children:\"        (isFocused || shouldShow) &&\"})}),`\n`,(0,n.jsx)(e.span,{className:\"line\",children:(0,n.jsx)(e.span,{children:\"        getHandleVisibility(\"})}),`\n`,(0,n.jsx)(e.span,{className:\"line\",children:(0,n.jsx)(e.span,{children:\"          position,\"})}),`\n`,(0,n.jsx)(e.span,{className:\"line\",children:(0,n.jsx)(e.span,{children:\"          signalWidget.value.corner,\"})}),`\n`,(0,n.jsx)(e.span,{className:\"line\",children:(0,n.jsx)(e.span,{children:\"          signalWidget.value.dimensions.isFullWidth,\"})}),`\n`,(0,n.jsx)(e.span,{className:\"line\",children:(0,n.jsx)(e.span,{children:\"          signalWidget.value.dimensions.isFullHeight,\"})}),`\n`,(0,n.jsx)(e.span,{className:\"line\",children:(0,n.jsx)(e.span,{children:\"        );\"})})]})})}),`\n`,(0,n.jsx)(e.h3,{id:\"about-me\",children:\"About me:\"}),`\n`,(0,n.jsxs)(e.p,{children:[\"Hey, my name is \",(0,n.jsx)(e.a,{href:\"https://ramunarasinga.com\",children:\"Ramu Narasinga\"}),\". I study large open-source projects and create content about their codebase architecture and best practices, sharing it through articles, videos.\"]}),`\n`,(0,n.jsx)(e.p,{children:(0,n.jsx)(e.em,{children:(0,n.jsxs)(e.strong,{children:[\"I am open to work on interesting projects. Send me an email at \",(0,n.jsx)(e.a,{href:\"mailto:ramu.narasinga@gmail.com\",children:\"ramu.narasinga@gmail.com\"})]})})}),`\n`,(0,n.jsxs)(e.p,{children:[\"My Github\\u200A\\u2014\\u200A \",(0,n.jsx)(e.a,{href:\"https://github.com/ramu-narasinga\",children:\"https://github.com/ramu-narasinga\"})]}),`\n`,(0,n.jsxs)(e.p,{children:[\"My website\\u200A\\u2014\\u200A \",(0,n.jsx)(e.a,{href:\"https://ramunarasinga.com/\",children:\"https://ramunarasinga.com\"})]}),`\n`,(0,n.jsxs)(e.p,{children:[\"My Youtube channel\\u200A\\u2014\\u200A \",(0,n.jsx)(e.a,{href:\"https://www.youtube.com/@thinkthroo\",children:\"https://www.youtube.com/@thinkthroo\"})]}),`\n`,(0,n.jsxs)(e.p,{children:[\"Learning platform\\u200A\\u2014\\u200A \",(0,n.jsx)(e.a,{href:\"https://thinkthroo.com/\",children:\"https://thinkthroo.com\"})]}),`\n`,(0,n.jsxs)(e.p,{children:[\"Codebase Architecture\\u200A\\u2014\\u200A \",(0,n.jsx)(e.a,{href:\"https://app.thinkthroo.com/architecture\",children:\"https://app.thinkthroo.com/architecture\"})]}),`\n`,(0,n.jsxs)(e.p,{children:[\"Best practices\\u200A\\u2014\\u200A \",(0,n.jsx)(e.a,{href:\"https://app.thinkthroo.com/best-practices\",children:\"https://app.thinkthroo.com/best-practices\"})]}),`\n`,(0,n.jsxs)(e.p,{children:[\"Production-grade projects\\u200A\\u2014\\u200A \",(0,n.jsx)(e.a,{href:\"https://app.thinkthroo.com/production-grade-projects\",children:\"https://app.thinkthroo.com/production-grade-projects\"})]}),`\n`,(0,n.jsx)(e.h3,{id:\"references\",children:\"References:\"}),`\n`,(0,n.jsxs)(e.ol,{children:[`\n`,(0,n.jsxs)(e.li,{children:[`\n`,(0,n.jsx)(e.p,{children:(0,n.jsx)(e.a,{href:\"https://github.com/aidenybai/react-scan/blob/main/packages/scan/src/core/index.ts#L260\",children:\"https://github.com/aidenybai/react-scan/blob/main/packages/scan/src/core/index.ts#L260\"})}),`\n`]}),`\n`,(0,n.jsxs)(e.li,{children:[`\n`,(0,n.jsx)(e.p,{children:(0,n.jsx)(e.a,{href:\"https://github.com/search?q=repo%3Aaidenybai%2Freact-scan%20Store&type=code\",children:\"https://github.com/search?q=repo%3Aaidenybai%2Freact-scan%20Store&type=code\"})}),`\n`]}),`\n`,(0,n.jsxs)(e.li,{children:[`\n`,(0,n.jsx)(e.p,{children:(0,n.jsx)(e.a,{href:\"https://github.com/aidenybai/react-scan?tab=readme-ov-file#api-reference\",children:\"https://github.com/aidenybai/react-scan?tab=readme-ov-file#api-reference\"})}),`\n`]}),`\n`,(0,n.jsxs)(e.li,{children:[`\n`,(0,n.jsx)(e.p,{children:(0,n.jsx)(e.a,{href:\"https://preactjs.com/guide/v10/signals/\",children:\"https://preactjs.com/guide/v10/signals/\"})}),`\n`]}),`\n`]})]})}function o(a={}){let{wrapper:e}=a.components||{};return e?(0,n.jsx)(e,{...a,children:(0,n.jsx)(h,{...a})}):h(a)}return N(v);})();\n;return Component;"
  },
  "_id": "blog/State-management-in-react.mdx",
  "_raw": {
    "sourceFilePath": "blog/State-management-in-react.mdx",
    "sourceFileName": "State-management-in-react.mdx",
    "sourceFileDir": "blog",
    "contentType": "mdx",
    "flattenedPath": "blog/State-management-in-react"
  },
  "type": "Doc",
  "slug": "/blog/State-management-in-react",
  "slugAsParams": "State-management-in-react"
}