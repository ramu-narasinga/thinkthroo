{
  "title": "Set() usage in Zustand source code.\r",
  "published": false,
  "featured": false,
  "component": false,
  "toc": true,
  "body": {
    "raw": "\r\nIn this article, we will understand how Set() method is used in [Zustand’s source code](https://github.com/pmndrs/zustand/blob/main/src/vanilla.ts#L71).\r\n\r\n![](https://miro.medium.com/v2/resize:fit:875/1*OmmD1X7HpeX2fPvhRTfuOA.png)\r\n\r\nso the listeners in Zustand are basically a [Set](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Set). The above code snippet is picked from [vanilla.ts](https://github.com/pmndrs/zustand/blob/main/src/vanilla.ts#L71)\r\n\r\n# **Set**\r\n\r\nThe `Set` object lets you store unique values of any type, whether [primitive values](https://developer.mozilla.org/en-US/docs/Glossary/Primitive) or object references. `Set` objects are collections of values. A value in the set may only occur once; it is unique in the set's collection. You can iterate through the elements of a set in insertion order. — [MDN Docs](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Set)\r\n\r\n```javascript\r\nconst mySet1 = new Set();\r\n\r\nmySet1.add(1); // Set(1) { 1 }\r\nmySet1.add(5); // Set(2) { 1, 5 }\r\nmySet1.add(5); // Set(2) { 1, 5 }\r\nmySet1.add(\"some text\"); // Set(3) { 1, 5, 'some text' }\r\n\r\nfor (const item of mySet1) {\r\n  console.log(item);\r\n}\r\n// 1, 5, 'some text'\r\n```\r\n\r\nlisteners are added in a function subscribe in Zustand. Let’s take a closer look at subscribe\r\n\r\n# **subscribe**\r\n\r\nHow is subscribe used in a React project? the below explanation is picked from Zustand’s Readme.\r\n\r\nThe subscribe function allows components to bind to a state-portion without forcing re-render on changes. Best combine it with useEffect for automatic unsubscribe on unmount. This can make a [drastic](https://codesandbox.io/s/peaceful-johnson-txtws) performance impact when you are allowed to mutate the view directly.\r\n\r\n```javascript\r\nconst useScratchStore = create((set) => ({ scratches: 0, ... }))\r\nconst Component = () => {\r\n  // Fetch initial state\r\n  const scratchRef = useRef(useScratchStore.getState().scratches)\r\n  // Connect to the store on mount, disconnect on unmount, catch state-changes in a reference\r\n  useEffect(() => useScratchStore.subscribe(\r\n    state => (scratchRef.current = state.scratches)\r\n  ), [])\r\n  ...\r\n```\r\n\r\nLet’s now look at the subscribe source code in Zustand.\r\n\r\n```javascript\r\nconst subscribe: StoreApi<TState>['subscribe'] = (listener) => {\r\n    listeners.add(listener)\r\n    // Unsubscribe\r\n    return () => listeners.delete(listener)\r\n}\r\n```\r\n\r\nsubscribe simply adds the listener to the listeners Set.\r\n\r\nLet’s see what the logs from experimentation say. To add the console.log statements, I compiled Zustand using the command `pnpm run build` and copied the dist into `examples/demo/src`. Looks hacky, but hey we are experimenting and figuring out how Zustand works internally.\r\n\r\n![](https://miro.medium.com/v2/resize:fit:875/1*ctFSmLkfJb8Y_8K-kYXSPA.png)\r\n\r\n![](https://miro.medium.com/v2/resize:fit:875/1*hmwr4QJlEjom-2zCEqpdJg.png)\r\n\r\nThis is how the listeners Set looks like\r\n\r\n![](https://miro.medium.com/v2/resize:fit:875/1*F0iBPkLIR2rdZ3_D4cC_Ag.png)\r\n\r\nI subscribed to changes in App.jsx\r\n\r\n```javascript\r\n// Subscribe to changes in the state\r\nuseStore.subscribe((state) => {\r\n  console.log(\"State changed: \", state);\r\n});\r\n```\r\n\r\nAnother observation is that, there is a additional listener that got added to this set:\r\n\r\n```javascript\r\nƒ () {\r\n  if (checkIfSnapshotChanged(inst)) {\r\n    forceStoreRerender(fiber);\r\n  }\r\n}\r\n```\r\n\r\n# **About me:**\r\n\r\nHey, my name is Ramu Narasinga. I study large open-source projects and create content about their codebase architecture and best practices, sharing it through articles, videos.\r\n\r\nI am open to work on interesting projects. Send me an email at ramu.narasinga@gmail.com\r\n\r\nMy Github — [https://github.com/ramu-narasinga](https://github.com/ramu-narasinga)\r\n\r\nMy website — [https://ramunarasinga.com](https://ramunarasinga.com/)\r\n\r\nMy Youtube channel — [https://www.youtube.com/@thinkthroo](https://www.youtube.com/@thinkthroo)\r\n\r\nLearning platform — [https://thinkthroo.com](https://thinkthroo.com/)\r\n\r\nCodebase Architecture — [https://app.thinkthroo.com/architecture](https://app.thinkthroo.com/architecture)\r\n\r\nBest practices — [https://app.thinkthroo.com/best-practices](https://app.thinkthroo.com/best-practices)\r\n\r\nProduction-grade projects — [https://app.thinkthroo.com/production-grade-projects](https://app.thinkthroo.com/production-grade-projects)\r\n\r\n# **References:**\r\n\r\n1. [https://github.com/pmndrs/zustand/blob/main/src/vanilla.ts#L62](https://github.com/pmndrs/zustand/blob/main/src/vanilla.ts#L62)\r\n    \r\n2. [https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global\\_Objects/Set](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Set)\r\n    \r\n3. [https://github.com/pmndrs/zustand/tree/main?tab=readme-ov-file#transient-updates-for-often-occurring-state-changes](https://github.com/pmndrs/zustand/tree/main?tab=readme-ov-file#transient-updates-for-often-occurring-state-changes)\r\n",
    "code": "var Component=(()=>{var h=Object.create;var c=Object.defineProperty;var p=Object.getOwnPropertyDescriptor;var y=Object.getOwnPropertyNames;var m=Object.getPrototypeOf,u=Object.prototype.hasOwnProperty;var g=(l,e)=>()=>(e||l((e={exports:{}}).exports,e),e.exports),b=(l,e)=>{for(var s in e)c(l,s,{get:e[s],enumerable:!0})},o=(l,e,s,t)=>{if(e&&typeof e==\"object\"||typeof e==\"function\")for(let r of y(e))!u.call(l,r)&&r!==s&&c(l,r,{get:()=>e[r],enumerable:!(t=p(e,r))||t.enumerable});return l};var f=(l,e,s)=>(s=l!=null?h(m(l)):{},o(e||!l||!l.__esModule?c(s,\"default\",{value:l,enumerable:!0}):s,l)),S=l=>o(c({},\"__esModule\",{value:!0}),l);var i=g((w,a)=>{a.exports=_jsx_runtime});var N={};b(N,{default:()=>d,frontmatter:()=>v});var n=f(i()),v={title:\"Set() usage in Zustand source code.\"};function F(l){let e={a:\"a\",code:\"code\",div:\"div\",h1:\"h1\",img:\"img\",li:\"li\",ol:\"ol\",p:\"p\",pre:\"pre\",span:\"span\",strong:\"strong\",...l.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(e.p,{children:[\"In this article, we will understand how Set() method is used in \",(0,n.jsx)(e.a,{href:\"https://github.com/pmndrs/zustand/blob/main/src/vanilla.ts#L71\",children:\"Zustand\\u2019s source code\"}),\".\"]}),`\n`,(0,n.jsx)(e.p,{children:(0,n.jsx)(e.img,{src:\"https://miro.medium.com/v2/resize:fit:875/1*OmmD1X7HpeX2fPvhRTfuOA.png\",alt:\"\"})}),`\n`,(0,n.jsxs)(e.p,{children:[\"so the listeners in Zustand are basically a \",(0,n.jsx)(e.a,{href:\"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Set\",children:\"Set\"}),\". The above code snippet is picked from \",(0,n.jsx)(e.a,{href:\"https://github.com/pmndrs/zustand/blob/main/src/vanilla.ts#L71\",children:\"vanilla.ts\"})]}),`\n`,(0,n.jsx)(e.h1,{id:\"set\",children:(0,n.jsx)(e.strong,{children:\"Set\"})}),`\n`,(0,n.jsxs)(e.p,{children:[\"The \",(0,n.jsx)(e.code,{children:\"Set\"}),\" object lets you store unique values of any type, whether \",(0,n.jsx)(e.a,{href:\"https://developer.mozilla.org/en-US/docs/Glossary/Primitive\",children:\"primitive values\"}),\" or object references. \",(0,n.jsx)(e.code,{children:\"Set\"}),\" objects are collections of values. A value in the set may only occur once; it is unique in the set's collection. You can iterate through the elements of a set in insertion order. \\u2014 \",(0,n.jsx)(e.a,{href:\"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Set\",children:\"MDN Docs\"})]}),`\n`,(0,n.jsx)(e.div,{\"data-rehype-pretty-code-fragment\":\"\",children:(0,n.jsx)(e.pre,{\"data-language\":\"javascript\",\"data-theme\":\"default\",children:(0,n.jsxs)(e.code,{\"data-language\":\"javascript\",\"data-theme\":\"default\",children:[(0,n.jsxs)(e.span,{className:\"line\",children:[(0,n.jsx)(e.span,{style:{color:\"#FFF8\"},children:\"const\"}),(0,n.jsx)(e.span,{style:{color:\"#FFF\"},children:\" mySet1 \"}),(0,n.jsx)(e.span,{style:{color:\"#FFF8\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#FFF8\"},children:\" new\"}),(0,n.jsx)(e.span,{style:{color:\"#FFF\"},children:\" Set\"}),(0,n.jsx)(e.span,{style:{color:\"#FFF8\"},children:\"();\"})]}),`\n`,(0,n.jsx)(e.span,{className:\"line\",children:\" \"}),`\n`,(0,n.jsxs)(e.span,{className:\"line\",children:[(0,n.jsx)(e.span,{style:{color:\"#FFF\"},children:\"mySet1\"}),(0,n.jsx)(e.span,{style:{color:\"#FFF8\"},children:\".\"}),(0,n.jsx)(e.span,{style:{color:\"#FFF\"},children:\"add\"}),(0,n.jsx)(e.span,{style:{color:\"#FFF8\"},children:\"(1);\"}),(0,n.jsx)(e.span,{style:{color:\"#FFF8\"},children:\" //\"}),(0,n.jsx)(e.span,{style:{color:\"#FFF4\"},children:\" Set(1) { 1 }\"})]}),`\n`,(0,n.jsxs)(e.span,{className:\"line\",children:[(0,n.jsx)(e.span,{style:{color:\"#FFF\"},children:\"mySet1\"}),(0,n.jsx)(e.span,{style:{color:\"#FFF8\"},children:\".\"}),(0,n.jsx)(e.span,{style:{color:\"#FFF\"},children:\"add\"}),(0,n.jsx)(e.span,{style:{color:\"#FFF8\"},children:\"(5);\"}),(0,n.jsx)(e.span,{style:{color:\"#FFF8\"},children:\" //\"}),(0,n.jsx)(e.span,{style:{color:\"#FFF4\"},children:\" Set(2) { 1, 5 }\"})]}),`\n`,(0,n.jsxs)(e.span,{className:\"line\",children:[(0,n.jsx)(e.span,{style:{color:\"#FFF\"},children:\"mySet1\"}),(0,n.jsx)(e.span,{style:{color:\"#FFF8\"},children:\".\"}),(0,n.jsx)(e.span,{style:{color:\"#FFF\"},children:\"add\"}),(0,n.jsx)(e.span,{style:{color:\"#FFF8\"},children:\"(5);\"}),(0,n.jsx)(e.span,{style:{color:\"#FFF8\"},children:\" //\"}),(0,n.jsx)(e.span,{style:{color:\"#FFF4\"},children:\" Set(2) { 1, 5 }\"})]}),`\n`,(0,n.jsxs)(e.span,{className:\"line\",children:[(0,n.jsx)(e.span,{style:{color:\"#FFF\"},children:\"mySet1\"}),(0,n.jsx)(e.span,{style:{color:\"#FFF8\"},children:\".\"}),(0,n.jsx)(e.span,{style:{color:\"#FFF\"},children:\"add\"}),(0,n.jsx)(e.span,{style:{color:\"#FFF8\"},children:\"(\"}),(0,n.jsx)(e.span,{style:{color:\"#FFF8\"},children:'\"some text\"'}),(0,n.jsx)(e.span,{style:{color:\"#FFF8\"},children:\");\"}),(0,n.jsx)(e.span,{style:{color:\"#FFF8\"},children:\" //\"}),(0,n.jsx)(e.span,{style:{color:\"#FFF4\"},children:\" Set(3) { 1, 5, 'some text' }\"})]}),`\n`,(0,n.jsx)(e.span,{className:\"line\",children:\" \"}),`\n`,(0,n.jsxs)(e.span,{className:\"line\",children:[(0,n.jsx)(e.span,{style:{color:\"#FFF8\"},children:\"for\"}),(0,n.jsx)(e.span,{style:{color:\"#FFF8\"},children:\" (const\"}),(0,n.jsx)(e.span,{style:{color:\"#FFF\"},children:\" item \"}),(0,n.jsx)(e.span,{style:{color:\"#FFF8\"},children:\"of\"}),(0,n.jsx)(e.span,{style:{color:\"#FFF\"},children:\" mySet1\"}),(0,n.jsx)(e.span,{style:{color:\"#FFF8\"},children:\")\"}),(0,n.jsx)(e.span,{style:{color:\"#FFF8\"},children:\" {\"})]}),`\n`,(0,n.jsxs)(e.span,{className:\"line\",children:[(0,n.jsx)(e.span,{style:{color:\"#FFF\"},children:\"  console\"}),(0,n.jsx)(e.span,{style:{color:\"#FFF8\"},children:\".\"}),(0,n.jsx)(e.span,{style:{color:\"#FFF\"},children:\"log\"}),(0,n.jsx)(e.span,{style:{color:\"#FFF8\"},children:\"(\"}),(0,n.jsx)(e.span,{style:{color:\"#FFF\"},children:\"item\"}),(0,n.jsx)(e.span,{style:{color:\"#FFF8\"},children:\");\"})]}),`\n`,(0,n.jsx)(e.span,{className:\"line\",children:(0,n.jsx)(e.span,{style:{color:\"#FFF8\"},children:\"}\"})}),`\n`,(0,n.jsxs)(e.span,{className:\"line\",children:[(0,n.jsx)(e.span,{style:{color:\"#FFF8\"},children:\"//\"}),(0,n.jsx)(e.span,{style:{color:\"#FFF4\"},children:\" 1, 5, 'some text'\"})]})]})})}),`\n`,(0,n.jsx)(e.p,{children:\"listeners are added in a function subscribe in Zustand. Let\\u2019s take a closer look at subscribe\"}),`\n`,(0,n.jsx)(e.h1,{id:\"subscribe\",children:(0,n.jsx)(e.strong,{children:\"subscribe\"})}),`\n`,(0,n.jsx)(e.p,{children:\"How is subscribe used in a React project? the below explanation is picked from Zustand\\u2019s Readme.\"}),`\n`,(0,n.jsxs)(e.p,{children:[\"The subscribe function allows components to bind to a state-portion without forcing re-render on changes. Best combine it with useEffect for automatic unsubscribe on unmount. This can make a \",(0,n.jsx)(e.a,{href:\"https://codesandbox.io/s/peaceful-johnson-txtws\",children:\"drastic\"}),\" performance impact when you are allowed to mutate the view directly.\"]}),`\n`,(0,n.jsx)(e.div,{\"data-rehype-pretty-code-fragment\":\"\",children:(0,n.jsx)(e.pre,{\"data-language\":\"javascript\",\"data-theme\":\"default\",children:(0,n.jsxs)(e.code,{\"data-language\":\"javascript\",\"data-theme\":\"default\",children:[(0,n.jsxs)(e.span,{className:\"line\",children:[(0,n.jsx)(e.span,{style:{color:\"#FFF8\"},children:\"const\"}),(0,n.jsx)(e.span,{style:{color:\"#FFF\"},children:\" useScratchStore \"}),(0,n.jsx)(e.span,{style:{color:\"#FFF8\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#FFF\"},children:\" create\"}),(0,n.jsx)(e.span,{style:{color:\"#FFF8\"},children:\"((\"}),(0,n.jsx)(e.span,{style:{color:\"#FFF\"},children:\"set\"}),(0,n.jsx)(e.span,{style:{color:\"#FFF8\"},children:\")\"}),(0,n.jsx)(e.span,{style:{color:\"#FFF8\"},children:\" =>\"}),(0,n.jsx)(e.span,{style:{color:\"#FFF8\"},children:\" ({\"}),(0,n.jsx)(e.span,{style:{color:\"#FFF\"},children:\" scratches\"}),(0,n.jsx)(e.span,{style:{color:\"#FFF8\"},children:\":\"}),(0,n.jsx)(e.span,{style:{color:\"#FFF8\"},children:\" 0,\"}),(0,n.jsx)(e.span,{style:{color:\"#FFF8\"},children:\" ...\"}),(0,n.jsx)(e.span,{style:{color:\"#FFF8\"},children:\" }))\"})]}),`\n`,(0,n.jsxs)(e.span,{className:\"line\",children:[(0,n.jsx)(e.span,{style:{color:\"#FFF8\"},children:\"const\"}),(0,n.jsx)(e.span,{style:{color:\"#FFF\",fontWeight:\"bold\"},children:\" Component\"}),(0,n.jsx)(e.span,{style:{color:\"#FFF8\"},children:\" =\"}),(0,n.jsx)(e.span,{style:{color:\"#FFF8\"},children:\" ()\"}),(0,n.jsx)(e.span,{style:{color:\"#FFF8\"},children:\" =>\"}),(0,n.jsx)(e.span,{style:{color:\"#FFF8\"},children:\" {\"})]}),`\n`,(0,n.jsxs)(e.span,{className:\"line\",children:[(0,n.jsx)(e.span,{style:{color:\"#FFF8\"},children:\"  //\"}),(0,n.jsx)(e.span,{style:{color:\"#FFF4\"},children:\" Fetch initial state\"})]}),`\n`,(0,n.jsxs)(e.span,{className:\"line\",children:[(0,n.jsx)(e.span,{style:{color:\"#FFF8\"},children:\"  const\"}),(0,n.jsx)(e.span,{style:{color:\"#FFF\"},children:\" scratchRef \"}),(0,n.jsx)(e.span,{style:{color:\"#FFF8\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#FFF\"},children:\" useRef\"}),(0,n.jsx)(e.span,{style:{color:\"#FFF8\"},children:\"(\"}),(0,n.jsx)(e.span,{style:{color:\"#FFF\"},children:\"useScratchStore\"}),(0,n.jsx)(e.span,{style:{color:\"#FFF8\"},children:\".\"}),(0,n.jsx)(e.span,{style:{color:\"#FFF\"},children:\"getState\"}),(0,n.jsx)(e.span,{style:{color:\"#FFF8\"},children:\"().\"}),(0,n.jsx)(e.span,{style:{color:\"#FFF\"},children:\"scratches\"}),(0,n.jsx)(e.span,{style:{color:\"#FFF8\"},children:\")\"})]}),`\n`,(0,n.jsxs)(e.span,{className:\"line\",children:[(0,n.jsx)(e.span,{style:{color:\"#FFF8\"},children:\"  //\"}),(0,n.jsx)(e.span,{style:{color:\"#FFF4\"},children:\" Connect to the store on mount, disconnect on unmount, catch state-changes in a reference\"})]}),`\n`,(0,n.jsxs)(e.span,{className:\"line\",children:[(0,n.jsx)(e.span,{style:{color:\"#FFF\"},children:\"  useEffect\"}),(0,n.jsx)(e.span,{style:{color:\"#FFF8\"},children:\"(()\"}),(0,n.jsx)(e.span,{style:{color:\"#FFF8\"},children:\" =>\"}),(0,n.jsx)(e.span,{style:{color:\"#FFF\"},children:\" useScratchStore\"}),(0,n.jsx)(e.span,{style:{color:\"#FFF8\"},children:\".\"}),(0,n.jsx)(e.span,{style:{color:\"#FFF\"},children:\"subscribe\"}),(0,n.jsx)(e.span,{style:{color:\"#FFF8\"},children:\"(\"})]}),`\n`,(0,n.jsxs)(e.span,{className:\"line\",children:[(0,n.jsx)(e.span,{style:{color:\"#FFF\"},children:\"    state \"}),(0,n.jsx)(e.span,{style:{color:\"#FFF8\"},children:\"=>\"}),(0,n.jsx)(e.span,{style:{color:\"#FFF8\"},children:\" (\"}),(0,n.jsx)(e.span,{style:{color:\"#FFF\"},children:\"scratchRef\"}),(0,n.jsx)(e.span,{style:{color:\"#FFF8\"},children:\".\"}),(0,n.jsx)(e.span,{style:{color:\"#FFF\"},children:\"current \"}),(0,n.jsx)(e.span,{style:{color:\"#FFF8\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#FFF\"},children:\" state\"}),(0,n.jsx)(e.span,{style:{color:\"#FFF8\"},children:\".\"}),(0,n.jsx)(e.span,{style:{color:\"#FFF\"},children:\"scratches\"}),(0,n.jsx)(e.span,{style:{color:\"#FFF8\"},children:\")\"})]}),`\n`,(0,n.jsxs)(e.span,{className:\"line\",children:[(0,n.jsx)(e.span,{style:{color:\"#FFF8\"},children:\"  ),\"}),(0,n.jsx)(e.span,{style:{color:\"#FFF8\"},children:\" [])\"})]}),`\n`,(0,n.jsx)(e.span,{className:\"line\",children:(0,n.jsx)(e.span,{style:{color:\"#FFF8\"},children:\"  ...\"})})]})})}),`\n`,(0,n.jsx)(e.p,{children:\"Let\\u2019s now look at the subscribe source code in Zustand.\"}),`\n`,(0,n.jsx)(e.div,{\"data-rehype-pretty-code-fragment\":\"\",children:(0,n.jsx)(e.pre,{\"data-language\":\"javascript\",\"data-theme\":\"default\",children:(0,n.jsxs)(e.code,{\"data-language\":\"javascript\",\"data-theme\":\"default\",children:[(0,n.jsxs)(e.span,{className:\"line\",children:[(0,n.jsx)(e.span,{style:{color:\"#FFF8\"},children:\"const\"}),(0,n.jsx)(e.span,{style:{color:\"#FFF\",fontWeight:\"bold\"},children:\" subscribe\"}),(0,n.jsx)(e.span,{style:{color:\"#FFF8\"},children:\":\"}),(0,n.jsx)(e.span,{style:{color:\"#FFF\",fontWeight:\"bold\"},children:\" StoreApi\"}),(0,n.jsx)(e.span,{style:{color:\"#FFF8\"},children:\"<\"}),(0,n.jsx)(e.span,{style:{color:\"#FFF\",fontWeight:\"bold\"},children:\"TState\"}),(0,n.jsx)(e.span,{style:{color:\"#FFF8\"},children:\">[\"}),(0,n.jsx)(e.span,{style:{color:\"#FFF8\"},children:\"'subscribe'\"}),(0,n.jsx)(e.span,{style:{color:\"#FFF8\"},children:\"]\"}),(0,n.jsx)(e.span,{style:{color:\"#FFF8\"},children:\" =\"}),(0,n.jsx)(e.span,{style:{color:\"#FFF8\"},children:\" (\"}),(0,n.jsx)(e.span,{style:{color:\"#FFF\"},children:\"listener\"}),(0,n.jsx)(e.span,{style:{color:\"#FFF8\"},children:\")\"}),(0,n.jsx)(e.span,{style:{color:\"#FFF8\"},children:\" =>\"}),(0,n.jsx)(e.span,{style:{color:\"#FFF8\"},children:\" {\"})]}),`\n`,(0,n.jsxs)(e.span,{className:\"line\",children:[(0,n.jsx)(e.span,{style:{color:\"#FFF\"},children:\"    listeners\"}),(0,n.jsx)(e.span,{style:{color:\"#FFF8\"},children:\".\"}),(0,n.jsx)(e.span,{style:{color:\"#FFF\"},children:\"add\"}),(0,n.jsx)(e.span,{style:{color:\"#FFF8\"},children:\"(\"}),(0,n.jsx)(e.span,{style:{color:\"#FFF\"},children:\"listener\"}),(0,n.jsx)(e.span,{style:{color:\"#FFF8\"},children:\")\"})]}),`\n`,(0,n.jsxs)(e.span,{className:\"line\",children:[(0,n.jsx)(e.span,{style:{color:\"#FFF8\"},children:\"    //\"}),(0,n.jsx)(e.span,{style:{color:\"#FFF4\"},children:\" Unsubscribe\"})]}),`\n`,(0,n.jsxs)(e.span,{className:\"line\",children:[(0,n.jsx)(e.span,{style:{color:\"#FFF8\"},children:\"    return\"}),(0,n.jsx)(e.span,{style:{color:\"#FFF8\"},children:\" ()\"}),(0,n.jsx)(e.span,{style:{color:\"#FFF8\"},children:\" =>\"}),(0,n.jsx)(e.span,{style:{color:\"#FFF\"},children:\" listeners\"}),(0,n.jsx)(e.span,{style:{color:\"#FFF8\"},children:\".\"}),(0,n.jsx)(e.span,{style:{color:\"#FFF\"},children:\"delete\"}),(0,n.jsx)(e.span,{style:{color:\"#FFF8\"},children:\"(\"}),(0,n.jsx)(e.span,{style:{color:\"#FFF\"},children:\"listener\"}),(0,n.jsx)(e.span,{style:{color:\"#FFF8\"},children:\")\"})]}),`\n`,(0,n.jsx)(e.span,{className:\"line\",children:(0,n.jsx)(e.span,{style:{color:\"#FFF8\"},children:\"}\"})})]})})}),`\n`,(0,n.jsx)(e.p,{children:\"subscribe simply adds the listener to the listeners Set.\"}),`\n`,(0,n.jsxs)(e.p,{children:[\"Let\\u2019s see what the logs from experimentation say. To add the console.log statements, I compiled Zustand using the command \",(0,n.jsx)(e.code,{children:\"pnpm run build\"}),\" and copied the dist into \",(0,n.jsx)(e.code,{children:\"examples/demo/src\"}),\". Looks hacky, but hey we are experimenting and figuring out how Zustand works internally.\"]}),`\n`,(0,n.jsx)(e.p,{children:(0,n.jsx)(e.img,{src:\"https://miro.medium.com/v2/resize:fit:875/1*ctFSmLkfJb8Y_8K-kYXSPA.png\",alt:\"\"})}),`\n`,(0,n.jsx)(e.p,{children:(0,n.jsx)(e.img,{src:\"https://miro.medium.com/v2/resize:fit:875/1*hmwr4QJlEjom-2zCEqpdJg.png\",alt:\"\"})}),`\n`,(0,n.jsx)(e.p,{children:\"This is how the listeners Set looks like\"}),`\n`,(0,n.jsx)(e.p,{children:(0,n.jsx)(e.img,{src:\"https://miro.medium.com/v2/resize:fit:875/1*F0iBPkLIR2rdZ3_D4cC_Ag.png\",alt:\"\"})}),`\n`,(0,n.jsx)(e.p,{children:\"I subscribed to changes in App.jsx\"}),`\n`,(0,n.jsx)(e.div,{\"data-rehype-pretty-code-fragment\":\"\",children:(0,n.jsx)(e.pre,{\"data-language\":\"javascript\",\"data-theme\":\"default\",children:(0,n.jsxs)(e.code,{\"data-language\":\"javascript\",\"data-theme\":\"default\",children:[(0,n.jsxs)(e.span,{className:\"line\",children:[(0,n.jsx)(e.span,{style:{color:\"#FFF8\"},children:\"//\"}),(0,n.jsx)(e.span,{style:{color:\"#FFF4\"},children:\" Subscribe to changes in the state\"})]}),`\n`,(0,n.jsxs)(e.span,{className:\"line\",children:[(0,n.jsx)(e.span,{style:{color:\"#FFF\"},children:\"useStore\"}),(0,n.jsx)(e.span,{style:{color:\"#FFF8\"},children:\".\"}),(0,n.jsx)(e.span,{style:{color:\"#FFF\"},children:\"subscribe\"}),(0,n.jsx)(e.span,{style:{color:\"#FFF8\"},children:\"((\"}),(0,n.jsx)(e.span,{style:{color:\"#FFF\"},children:\"state\"}),(0,n.jsx)(e.span,{style:{color:\"#FFF8\"},children:\")\"}),(0,n.jsx)(e.span,{style:{color:\"#FFF8\"},children:\" =>\"}),(0,n.jsx)(e.span,{style:{color:\"#FFF8\"},children:\" {\"})]}),`\n`,(0,n.jsxs)(e.span,{className:\"line\",children:[(0,n.jsx)(e.span,{style:{color:\"#FFF\"},children:\"  console\"}),(0,n.jsx)(e.span,{style:{color:\"#FFF8\"},children:\".\"}),(0,n.jsx)(e.span,{style:{color:\"#FFF\"},children:\"log\"}),(0,n.jsx)(e.span,{style:{color:\"#FFF8\"},children:\"(\"}),(0,n.jsx)(e.span,{style:{color:\"#FFF8\"},children:'\"State changed: \"'}),(0,n.jsx)(e.span,{style:{color:\"#FFF8\"},children:\",\"}),(0,n.jsx)(e.span,{style:{color:\"#FFF\"},children:\" state\"}),(0,n.jsx)(e.span,{style:{color:\"#FFF8\"},children:\");\"})]}),`\n`,(0,n.jsx)(e.span,{className:\"line\",children:(0,n.jsx)(e.span,{style:{color:\"#FFF8\"},children:\"});\"})})]})})}),`\n`,(0,n.jsx)(e.p,{children:\"Another observation is that, there is a additional listener that got added to this set:\"}),`\n`,(0,n.jsx)(e.div,{\"data-rehype-pretty-code-fragment\":\"\",children:(0,n.jsx)(e.pre,{\"data-language\":\"javascript\",\"data-theme\":\"default\",children:(0,n.jsxs)(e.code,{\"data-language\":\"javascript\",\"data-theme\":\"default\",children:[(0,n.jsxs)(e.span,{className:\"line\",children:[(0,n.jsx)(e.span,{style:{color:\"#FFF\"},children:\"\\u0192 \"}),(0,n.jsx)(e.span,{style:{color:\"#FFF8\"},children:\"()\"}),(0,n.jsx)(e.span,{style:{color:\"#FFF8\"},children:\" {\"})]}),`\n`,(0,n.jsxs)(e.span,{className:\"line\",children:[(0,n.jsx)(e.span,{style:{color:\"#FFF8\"},children:\"  if\"}),(0,n.jsx)(e.span,{style:{color:\"#FFF8\"},children:\" (\"}),(0,n.jsx)(e.span,{style:{color:\"#FFF\"},children:\"checkIfSnapshotChanged\"}),(0,n.jsx)(e.span,{style:{color:\"#FFF8\"},children:\"(\"}),(0,n.jsx)(e.span,{style:{color:\"#FFF\"},children:\"inst\"}),(0,n.jsx)(e.span,{style:{color:\"#FFF8\"},children:\"))\"}),(0,n.jsx)(e.span,{style:{color:\"#FFF8\"},children:\" {\"})]}),`\n`,(0,n.jsxs)(e.span,{className:\"line\",children:[(0,n.jsx)(e.span,{style:{color:\"#FFF\"},children:\"    forceStoreRerender\"}),(0,n.jsx)(e.span,{style:{color:\"#FFF8\"},children:\"(\"}),(0,n.jsx)(e.span,{style:{color:\"#FFF\"},children:\"fiber\"}),(0,n.jsx)(e.span,{style:{color:\"#FFF8\"},children:\");\"})]}),`\n`,(0,n.jsx)(e.span,{className:\"line\",children:(0,n.jsx)(e.span,{style:{color:\"#FFF8\"},children:\"  }\"})}),`\n`,(0,n.jsx)(e.span,{className:\"line\",children:(0,n.jsx)(e.span,{style:{color:\"#FFF8\"},children:\"}\"})})]})})}),`\n`,(0,n.jsx)(e.h1,{id:\"about-me\",children:(0,n.jsx)(e.strong,{children:\"About me:\"})}),`\n`,(0,n.jsx)(e.p,{children:\"Hey, my name is Ramu Narasinga. I study large open-source projects and create content about their codebase architecture and best practices, sharing it through articles, videos.\"}),`\n`,(0,n.jsxs)(e.p,{children:[\"I am open to work on interesting projects. Send me an email at \",(0,n.jsx)(e.a,{href:\"mailto:ramu.narasinga@gmail.com\",children:\"ramu.narasinga@gmail.com\"})]}),`\n`,(0,n.jsxs)(e.p,{children:[\"My Github \\u2014 \",(0,n.jsx)(e.a,{href:\"https://github.com/ramu-narasinga\",children:\"https://github.com/ramu-narasinga\"})]}),`\n`,(0,n.jsxs)(e.p,{children:[\"My website \\u2014 \",(0,n.jsx)(e.a,{href:\"https://ramunarasinga.com/\",children:\"https://ramunarasinga.com\"})]}),`\n`,(0,n.jsxs)(e.p,{children:[\"My Youtube channel \\u2014 \",(0,n.jsx)(e.a,{href:\"https://www.youtube.com/@thinkthroo\",children:\"https://www.youtube.com/@thinkthroo\"})]}),`\n`,(0,n.jsxs)(e.p,{children:[\"Learning platform \\u2014 \",(0,n.jsx)(e.a,{href:\"https://thinkthroo.com/\",children:\"https://thinkthroo.com\"})]}),`\n`,(0,n.jsxs)(e.p,{children:[\"Codebase Architecture \\u2014 \",(0,n.jsx)(e.a,{href:\"https://app.thinkthroo.com/architecture\",children:\"https://app.thinkthroo.com/architecture\"})]}),`\n`,(0,n.jsxs)(e.p,{children:[\"Best practices \\u2014 \",(0,n.jsx)(e.a,{href:\"https://app.thinkthroo.com/best-practices\",children:\"https://app.thinkthroo.com/best-practices\"})]}),`\n`,(0,n.jsxs)(e.p,{children:[\"Production-grade projects \\u2014 \",(0,n.jsx)(e.a,{href:\"https://app.thinkthroo.com/production-grade-projects\",children:\"https://app.thinkthroo.com/production-grade-projects\"})]}),`\n`,(0,n.jsx)(e.h1,{id:\"references\",children:(0,n.jsx)(e.strong,{children:\"References:\"})}),`\n`,(0,n.jsxs)(e.ol,{children:[`\n`,(0,n.jsxs)(e.li,{children:[`\n`,(0,n.jsx)(e.p,{children:(0,n.jsx)(e.a,{href:\"https://github.com/pmndrs/zustand/blob/main/src/vanilla.ts#L62\",children:\"https://github.com/pmndrs/zustand/blob/main/src/vanilla.ts#L62\"})}),`\n`]}),`\n`,(0,n.jsxs)(e.li,{children:[`\n`,(0,n.jsx)(e.p,{children:(0,n.jsx)(e.a,{href:\"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Set\",children:\"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Set\"})}),`\n`]}),`\n`,(0,n.jsxs)(e.li,{children:[`\n`,(0,n.jsx)(e.p,{children:(0,n.jsx)(e.a,{href:\"https://github.com/pmndrs/zustand/tree/main?tab=readme-ov-file#transient-updates-for-often-occurring-state-changes\",children:\"https://github.com/pmndrs/zustand/tree/main?tab=readme-ov-file#transient-updates-for-often-occurring-state-changes\"})}),`\n`]}),`\n`]})]})}function d(l={}){let{wrapper:e}=l.components||{};return e?(0,n.jsx)(e,{...l,children:(0,n.jsx)(F,{...l})}):F(l)}return S(N);})();\n;return Component;"
  },
  "_id": "blog/Set-usage-in-Zustand.mdx",
  "_raw": {
    "sourceFilePath": "blog/Set-usage-in-Zustand.mdx",
    "sourceFileName": "Set-usage-in-Zustand.mdx",
    "sourceFileDir": "blog",
    "contentType": "mdx",
    "flattenedPath": "blog/Set-usage-in-Zustand"
  },
  "type": "Doc",
  "slug": "/blog/Set-usage-in-Zustand",
  "slugAsParams": "Set-usage-in-Zustand"
}