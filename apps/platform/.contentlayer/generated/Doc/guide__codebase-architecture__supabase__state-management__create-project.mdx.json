{
  "title": "State management in Supabase\r",
  "published": false,
  "featured": false,
  "component": false,
  "toc": true,
  "body": {
    "raw": "\r\n[C: State management in creating a new project in Supabase]\r\n\r\nIn this guide, we analyse how adding a new project in your Supabase dashboard is handled. We \r\nreview the code behind this action and find out how the state is managed once a new project \r\nis added.\r\n\r\n# Where is the Create Project button?\r\n\r\nLocating where the \"Create Project\" button in the Supabase codebase is a good start. On the UI, you\r\nwill find this button at the route `/dashboard/projects`.\r\n\r\n[Insert screenshot of - Create Project button]\r\n\r\nIn the [projects.tsx, at line 171](https://github.com/supabase/supabase/blob/master/apps/studio/pages/projects.tsx#L71),\r\nyou will find this below code:\r\n\r\n```js\r\n{!navLayoutV2 && (\r\n  <div className=\"p-5\">\r\n    {IS_PLATFORM && projectCreationEnabled && isSuccess && (\r\n      <HomePageActions\r\n        search={search}\r\n        filterStatus={filterStatus}\r\n        setSearch={setSearch}\r\n        setFilterStatus={setFilterStatus}\r\n        organizations={organizations}\r\n      />\r\n    )}\r\n  </div>\r\n}\r\n```\r\n\r\n[HomePageActions.tsx](https://github.com/supabase/supabase/blob/master/apps/studio/components/interfaces/HomePageActions.tsx#L33)\r\nrenders this below shown elements.\r\n\r\n[Insert screenshot of list of actions above projects]\r\n\r\nIt is time to locate the code for to \"New Project\" button. In the [HomePageActions.tsx](https://github.com/supabase/supabase/blob/master/apps/studio/components/interfaces/HomePageActions.tsx#L47),\r\nyou will find this below code snippet - \r\n\r\n```\r\n<DropdownMenu>\r\n    <DropdownMenuTrigger asChild>\r\n      <Button type=\"primary\">\r\n        <span>New project</span>\r\n      </Button>\r\n    </DropdownMenuTrigger>\r\n    <DropdownMenuContent side=\"bottom\" align=\"center\">\r\n      <>\r\n        <DropdownMenuLabel>Choose organization</DropdownMenuLabel>\r\n        {organizations\r\n          .sort((a, b) => a.name.localeCompare(b.name))\r\n          .map((x) => (\r\n            <DropdownMenuItem key={x.slug} onClick={() => router.push(`/new/${x.slug}`)}>\r\n              {x.name}\r\n            </DropdownMenuItem>\r\n          ))}\r\n      </>\r\n    </DropdownMenuContent>\r\n</DropdownMenu>\r\n```\r\n\r\nWhen you click on New Project, what you see is a dropdown asking to choose the organization to which you will add\r\na project. At this point, there is no state management in place. A simple redirect to `/new/x.slug` occurs, here \r\nx.slug belongs to a organization's slug.\r\n\r\nWe still haven't learnt what happens after you add a new project, so far we found out that a redirect to \r\n`/new/{x.slug}` occurs. We now need to find the page.tsx based on this route.\r\n\r\n# new/[slug].tsx\r\n\r\nFollowing along the redirect to `/new/[slug].tsx`, we need to find the source code for this page. In the \r\n[pages/new/[slug].tsx](https://github.com/supabase/supabase/blob/master/apps/studio/pages/new/%5Bslug%5D.tsx), you\r\nwill find the code that renders this route.\r\n\r\nThis page shows a form and onSubmit, it redirects you to `/project/${res.ref}/building`. This below code snippet\r\nis picked from [/new/[slug].tsx](https://github.com/supabase/supabase/blob/master/apps/studio/pages/new/%5Bslug%5D.tsx#L371)\r\n\r\n```\r\n return (\r\n    <Form_Shadcn_ {...form}>\r\n      <form onSubmit={form.handleSubmit(onSubmit)}>\r\n        <Panel\r\n          loading={!isOrganizationsSuccess || isLoadingFreeProjectLimitCheck}\r\n          title={\r\n            <div key=\"panel-title\">\r\n              <h3>Create a new project</h3>\r\n```\r\n\r\n[handleSubmit function](https://github.com/supabase/supabase/blob/master/apps/studio/pages/new/%5Bslug%5D.tsx#L327) \r\ncalls a method named createProject at the end of the function.\r\n\r\n```\r\nfunction onSubmit() {\r\n  // ...\r\n  if (postgresVersion) {\r\n      if (!postgresVersion.match(/1[2-9]\\..*/)) {\r\n        toast.error(\r\n          `Invalid Postgres version, should start with a number between 12-19, a dot and additional characters, i.e. 15.2 or 15.2.0-3`\r\n        )\r\n      }\r\n\r\n      data['customSupabaseRequest'] = {\r\n        ami: { search_tags: { 'tag:postgresVersion': postgresVersion } },\r\n      }\r\n    }\r\n\r\n    createProject(data)\r\n}\r\n```\r\n\r\n[createProject function](https://github.com/supabase/supabase/blob/master/apps/studio/pages/new/%5Bslug%5D.tsx#L180) \r\nis a mutate function returned by `useProjectCreateMutation` hook. Check out the API layer to learn more about \r\nthese hooks.\r\n\r\n```\r\nconst {\r\n  mutate: createProject,\r\n  isLoading: isCreatingNewProject,\r\n  isSuccess: isSuccessNewProject,\r\n} = useProjectCreateMutation({\r\n  onSuccess: (res) => {\r\n    router.push(`/project/${res.ref}/building`)\r\n  },\r\n})\r\n```\r\n\r\nYou add project information such as name etc., and on sumit, you are redirected to a different page. There isn't much \r\nhassle and no complicated state management.",
    "code": "var Component=(()=>{var p=Object.create;var o=Object.defineProperty;var u=Object.getOwnPropertyDescriptor;var F=Object.getOwnPropertyNames;var m=Object.getPrototypeOf,g=Object.prototype.hasOwnProperty;var b=(r,e)=>()=>(e||r((e={exports:{}}).exports,e),e.exports),y=(r,e)=>{for(var t in e)o(r,t,{get:e[t],enumerable:!0})},l=(r,e,t,a)=>{if(e&&typeof e==\"object\"||typeof e==\"function\")for(let s of F(e))!g.call(r,s)&&s!==t&&o(r,s,{get:()=>e[s],enumerable:!(a=u(e,s))||a.enumerable});return r};var w=(r,e,t)=>(t=r!=null?p(m(r)):{},l(e||!r||!r.__esModule?o(t,\"default\",{value:r,enumerable:!0}):t,r)),f=r=>l(o({},\"__esModule\",{value:!0}),r);var i=b((P,c)=>{c.exports=_jsx_runtime});var x={};y(x,{default:()=>h,frontmatter:()=>j});var n=w(i()),j={title:\"State management in Supabase\"};function d(r){let e={a:\"a\",code:\"code\",div:\"div\",h1:\"h1\",p:\"p\",pre:\"pre\",span:\"span\",...r.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(e.p,{children:\"[C: State management in creating a new project in Supabase]\"}),`\n`,(0,n.jsx)(e.p,{children:`In this guide, we analyse how adding a new project in your Supabase dashboard is handled. We\\r\nreview the code behind this action and find out how the state is managed once a new project\\r\nis added.`}),`\n`,(0,n.jsx)(e.h1,{id:\"where-is-the-create-project-button\",children:\"Where is the Create Project button?\"}),`\n`,(0,n.jsxs)(e.p,{children:[`Locating where the \"Create Project\" button in the Supabase codebase is a good start. On the UI, you\\r\nwill find this button at the route `,(0,n.jsx)(e.code,{children:\"/dashboard/projects\"}),\".\"]}),`\n`,(0,n.jsx)(e.p,{children:\"[Insert screenshot of - Create Project button]\"}),`\n`,(0,n.jsxs)(e.p,{children:[\"In the \",(0,n.jsx)(e.a,{href:\"https://github.com/supabase/supabase/blob/master/apps/studio/pages/projects.tsx#L71\",children:\"projects.tsx, at line 171\"}),`,\\r\nyou will find this below code:`]}),`\n`,(0,n.jsx)(e.div,{\"data-rehype-pretty-code-fragment\":\"\",children:(0,n.jsx)(e.pre,{\"data-language\":\"js\",\"data-theme\":\"default\",children:(0,n.jsxs)(e.code,{\"data-language\":\"js\",\"data-theme\":\"default\",children:[(0,n.jsxs)(e.span,{className:\"line\",children:[(0,n.jsx)(e.span,{style:{color:\"#FFF8\"},children:\"{!\"}),(0,n.jsx)(e.span,{style:{color:\"#FFF\"},children:\"navLayoutV2 \"}),(0,n.jsx)(e.span,{style:{color:\"#FFF8\"},children:\"&&\"}),(0,n.jsx)(e.span,{style:{color:\"#FFF8\"},children:\" (\"})]}),`\n`,(0,n.jsxs)(e.span,{className:\"line\",children:[(0,n.jsx)(e.span,{style:{color:\"#FFF8\"},children:\"  <\"}),(0,n.jsx)(e.span,{style:{color:\"#FFF\"},children:\"div className\"}),(0,n.jsx)(e.span,{style:{color:\"#FFF8\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#FFF8\"},children:'\"p-5\"'}),(0,n.jsx)(e.span,{style:{color:\"#FFF8\"},children:\">\"})]}),`\n`,(0,n.jsxs)(e.span,{className:\"line\",children:[(0,n.jsx)(e.span,{style:{color:\"#FFF8\"},children:\"    {\"}),(0,n.jsx)(e.span,{style:{color:\"#FFF\"},children:\"IS_PLATFORM \"}),(0,n.jsx)(e.span,{style:{color:\"#FFF8\"},children:\"&&\"}),(0,n.jsx)(e.span,{style:{color:\"#FFF\"},children:\" projectCreationEnabled \"}),(0,n.jsx)(e.span,{style:{color:\"#FFF8\"},children:\"&&\"}),(0,n.jsx)(e.span,{style:{color:\"#FFF\"},children:\" isSuccess \"}),(0,n.jsx)(e.span,{style:{color:\"#FFF8\"},children:\"&&\"}),(0,n.jsx)(e.span,{style:{color:\"#FFF8\"},children:\" (\"})]}),`\n`,(0,n.jsxs)(e.span,{className:\"line\",children:[(0,n.jsx)(e.span,{style:{color:\"#FFF8\"},children:\"      <\"}),(0,n.jsx)(e.span,{style:{color:\"#FFF\"},children:\"HomePageActions\"})]}),`\n`,(0,n.jsxs)(e.span,{className:\"line\",children:[(0,n.jsx)(e.span,{style:{color:\"#FFF\"},children:\"        search\"}),(0,n.jsx)(e.span,{style:{color:\"#FFF8\"},children:\"={\"}),(0,n.jsx)(e.span,{style:{color:\"#FFF\"},children:\"search\"}),(0,n.jsx)(e.span,{style:{color:\"#FFF8\"},children:\"}\"})]}),`\n`,(0,n.jsxs)(e.span,{className:\"line\",children:[(0,n.jsx)(e.span,{style:{color:\"#FFF\"},children:\"        filterStatus\"}),(0,n.jsx)(e.span,{style:{color:\"#FFF8\"},children:\"={\"}),(0,n.jsx)(e.span,{style:{color:\"#FFF\"},children:\"filterStatus\"}),(0,n.jsx)(e.span,{style:{color:\"#FFF8\"},children:\"}\"})]}),`\n`,(0,n.jsxs)(e.span,{className:\"line\",children:[(0,n.jsx)(e.span,{style:{color:\"#FFF\"},children:\"        setSearch\"}),(0,n.jsx)(e.span,{style:{color:\"#FFF8\"},children:\"={\"}),(0,n.jsx)(e.span,{style:{color:\"#FFF\"},children:\"setSearch\"}),(0,n.jsx)(e.span,{style:{color:\"#FFF8\"},children:\"}\"})]}),`\n`,(0,n.jsxs)(e.span,{className:\"line\",children:[(0,n.jsx)(e.span,{style:{color:\"#FFF\"},children:\"        setFilterStatus\"}),(0,n.jsx)(e.span,{style:{color:\"#FFF8\"},children:\"={\"}),(0,n.jsx)(e.span,{style:{color:\"#FFF\"},children:\"setFilterStatus\"}),(0,n.jsx)(e.span,{style:{color:\"#FFF8\"},children:\"}\"})]}),`\n`,(0,n.jsxs)(e.span,{className:\"line\",children:[(0,n.jsx)(e.span,{style:{color:\"#FFF\"},children:\"        organizations\"}),(0,n.jsx)(e.span,{style:{color:\"#FFF8\"},children:\"={\"}),(0,n.jsx)(e.span,{style:{color:\"#FFF\"},children:\"organizations\"}),(0,n.jsx)(e.span,{style:{color:\"#FFF8\"},children:\"}\"})]}),`\n`,(0,n.jsx)(e.span,{className:\"line\",children:(0,n.jsx)(e.span,{style:{color:\"#FFF8\"},children:\"      />\"})}),`\n`,(0,n.jsx)(e.span,{className:\"line\",children:(0,n.jsx)(e.span,{style:{color:\"#FFF8\"},children:\"    )}\"})}),`\n`,(0,n.jsxs)(e.span,{className:\"line\",children:[(0,n.jsx)(e.span,{style:{color:\"#FFF8\"},children:\"  </\"}),(0,n.jsx)(e.span,{style:{color:\"#FFF\"},children:\"div\"}),(0,n.jsx)(e.span,{style:{color:\"#FFF8\"},children:\">\"})]}),`\n`,(0,n.jsx)(e.span,{className:\"line\",children:(0,n.jsx)(e.span,{style:{color:\"#FFF\"},children:\"}\"})})]})})}),`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.a,{href:\"https://github.com/supabase/supabase/blob/master/apps/studio/components/interfaces/HomePageActions.tsx#L33\",children:\"HomePageActions.tsx\"}),`\\r\nrenders this below shown elements.`]}),`\n`,(0,n.jsx)(e.p,{children:\"[Insert screenshot of list of actions above projects]\"}),`\n`,(0,n.jsxs)(e.p,{children:['It is time to locate the code for to \"New Project\" button. In the ',(0,n.jsx)(e.a,{href:\"https://github.com/supabase/supabase/blob/master/apps/studio/components/interfaces/HomePageActions.tsx#L47\",children:\"HomePageActions.tsx\"}),`,\\r\nyou will find this below code snippet -`]}),`\n`,(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:`<DropdownMenu>\\r\n    <DropdownMenuTrigger asChild>\\r\n      <Button type=\"primary\">\\r\n        <span>New project</span>\\r\n      </Button>\\r\n    </DropdownMenuTrigger>\\r\n    <DropdownMenuContent side=\"bottom\" align=\"center\">\\r\n      <>\\r\n        <DropdownMenuLabel>Choose organization</DropdownMenuLabel>\\r\n        {organizations\\r\n          .sort((a, b) => a.name.localeCompare(b.name))\\r\n          .map((x) => (\\r\n            <DropdownMenuItem key={x.slug} onClick={() => router.push(\\`/new/\\${x.slug}\\`)}>\\r\n              {x.name}\\r\n            </DropdownMenuItem>\\r\n          ))}\\r\n      </>\\r\n    </DropdownMenuContent>\\r\n</DropdownMenu>\n`})}),`\n`,(0,n.jsxs)(e.p,{children:[`When you click on New Project, what you see is a dropdown asking to choose the organization to which you will add\\r\na project. At this point, there is no state management in place. A simple redirect to `,(0,n.jsx)(e.code,{children:\"/new/x.slug\"}),` occurs, here\\r\nx.slug belongs to a organization's slug.`]}),`\n`,(0,n.jsxs)(e.p,{children:[`We still haven't learnt what happens after you add a new project, so far we found out that a redirect to\\r\n`,(0,n.jsx)(e.code,{children:\"/new/{x.slug}\"}),\" occurs. We now need to find the page.tsx based on this route.\"]}),`\n`,(0,n.jsx)(e.h1,{id:\"newslugtsx\",children:\"new/[slug].tsx\"}),`\n`,(0,n.jsxs)(e.p,{children:[\"Following along the redirect to \",(0,n.jsx)(e.code,{children:\"/new/[slug].tsx\"}),`, we need to find the source code for this page. In the\\r\n`,(0,n.jsx)(e.a,{href:\"https://github.com/supabase/supabase/blob/master/apps/studio/pages/new/%5Bslug%5D.tsx\",children:\"pages/new/[slug].tsx\"}),`, you\\r\nwill find the code that renders this route.`]}),`\n`,(0,n.jsxs)(e.p,{children:[\"This page shows a form and onSubmit, it redirects you to \",(0,n.jsx)(e.code,{children:\"/project/${res.ref}/building\"}),`. This below code snippet\\r\nis picked from `,(0,n.jsx)(e.a,{href:\"https://github.com/supabase/supabase/blob/master/apps/studio/pages/new/%5Bslug%5D.tsx#L371\",children:\"/new/[slug].tsx\"})]}),`\n`,(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:` return (\\r\n    <Form_Shadcn_ {...form}>\\r\n      <form onSubmit={form.handleSubmit(onSubmit)}>\\r\n        <Panel\\r\n          loading={!isOrganizationsSuccess || isLoadingFreeProjectLimitCheck}\\r\n          title={\\r\n            <div key=\"panel-title\">\\r\n              <h3>Create a new project</h3>\n`})}),`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.a,{href:\"https://github.com/supabase/supabase/blob/master/apps/studio/pages/new/%5Bslug%5D.tsx#L327\",children:\"handleSubmit function\"}),`\\r\ncalls a method named createProject at the end of the function.`]}),`\n`,(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:`function onSubmit() {\\r\n  // ...\\r\n  if (postgresVersion) {\\r\n      if (!postgresVersion.match(/1[2-9]\\\\..*/)) {\\r\n        toast.error(\\r\n          \\`Invalid Postgres version, should start with a number between 12-19, a dot and additional characters, i.e. 15.2 or 15.2.0-3\\`\\r\n        )\\r\n      }\\r\n\\r\n      data['customSupabaseRequest'] = {\\r\n        ami: { search_tags: { 'tag:postgresVersion': postgresVersion } },\\r\n      }\\r\n    }\\r\n\\r\n    createProject(data)\\r\n}\n`})}),`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.a,{href:\"https://github.com/supabase/supabase/blob/master/apps/studio/pages/new/%5Bslug%5D.tsx#L180\",children:\"createProject function\"}),`\\r\nis a mutate function returned by `,(0,n.jsx)(e.code,{children:\"useProjectCreateMutation\"}),` hook. Check out the API layer to learn more about\\r\nthese hooks.`]}),`\n`,(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:`const {\\r\n  mutate: createProject,\\r\n  isLoading: isCreatingNewProject,\\r\n  isSuccess: isSuccessNewProject,\\r\n} = useProjectCreateMutation({\\r\n  onSuccess: (res) => {\\r\n    router.push(\\`/project/\\${res.ref}/building\\`)\\r\n  },\\r\n})\n`})}),`\n`,(0,n.jsx)(e.p,{children:`You add project information such as name etc., and on sumit, you are redirected to a different page. There isn't much\\r\nhassle and no complicated state management.`})]})}function h(r={}){let{wrapper:e}=r.components||{};return e?(0,n.jsx)(e,{...r,children:(0,n.jsx)(d,{...r})}):d(r)}return f(x);})();\n;return Component;"
  },
  "_id": "guide/codebase-architecture/supabase/state-management/create-project.mdx",
  "_raw": {
    "sourceFilePath": "guide/codebase-architecture/supabase/state-management/create-project.mdx",
    "sourceFileName": "create-project.mdx",
    "sourceFileDir": "guide/codebase-architecture/supabase/state-management",
    "contentType": "mdx",
    "flattenedPath": "guide/codebase-architecture/supabase/state-management/create-project"
  },
  "type": "Doc",
  "slug": "/guide/codebase-architecture/supabase/state-management/create-project",
  "slugAsParams": "codebase-architecture/supabase/state-management/create-project"
}