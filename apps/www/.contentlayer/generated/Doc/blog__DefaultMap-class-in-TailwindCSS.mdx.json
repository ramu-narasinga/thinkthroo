{
  "title": "DefaultMap class in TailwindCSS source code.\r",
  "published": false,
  "featured": false,
  "component": false,
  "toc": true,
  "body": {
    "raw": "\r\nIn this article, we analyse [DefaultMap class](https://github.com/tailwindlabs/tailwindcss/blob/next/packages/tailwindcss/src/utils/default-map.ts#L5) in Tailwind CSS source code. This is a map that can generate default values for keys that don’t exist. Generated default values are added to the map to avoid re-computation.\r\n\r\n```plaintext\r\n\r\n/**\r\n * A Map that can generate default values for keys that don't exist.\r\n * Generated default values are added to the map to avoid recomputation.\r\n */\r\nexport class DefaultMap<T = string, V = any> extends Map<T, V> {\r\n  constructor(private factory: (key: T, self: DefaultMap<T, V>) => V) {\r\n    super()\r\n  }\r\n\r\n  get(key: T): V {\r\n    let value = super.get(key)\r\n\r\n    if (value === undefined) {\r\n      value = this.factory(key, this)\r\n      this.set(key, value)\r\n    }\r\n\r\n    return value\r\n  }\r\n}\r\n```\r\n\r\nIn JavaScript, we have a [Map API](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Map) but there is no DefaultMap. This DefaultMap is a custom class that extends Map in [Tailwind CSS source code](https://github.com/tailwindlabs/tailwindcss/blob/next/packages/tailwindcss/src/utils/default-map.ts#L5).\r\n\r\nLet’s understand this code.\r\n\r\n```plaintext\r\nconstructor(private factory: (key: T, self: DefaultMap<T, V>) => V) {\r\n    super()\r\n}\r\n```\r\n\r\nDefaultMap is a class that has a constructor that expects a factory function. super() calls the parent class’s constructor, in this case, this is Map API and factory function’s second parameter is self: DefaultMap&lt;T, V&gt; which means it has access to `Map` instance.\r\n\r\n# **How DefaultMap is initialized?**\r\n\r\nLet’s find an example where this DefaultMap is initialised. [design-system.ts](https://github.com/tailwindlabs/tailwindcss/blob/c01b8254e822d4f328674357347ca0532f1283a0/packages/tailwindcss/src/design-system.ts#L40) desmonstrates usage of DefaultMap.\r\n\r\n![](https://miro.medium.com/v2/resize:fit:875/1*UatBnuEnp1OsRHJnMUQj9Q.png)\r\n\r\n```plaintext\r\nlet parsedVariants = new DefaultMap(\r\n                        (variant) => parseVariant(variant, designSystem)\r\n                     );\r\n```\r\n\r\nHere `(variant) => parseVariant(variant, designSystem)` becomes our factory method that adds a default if a key does not exist.\r\n\r\n```plaintext\r\nreturn {\r\n      kind: 'arbitrary',\r\n      selector,\r\n      compounds: true,\r\n      relative,\r\n  }\r\n```\r\n\r\nThis is the value returned by [parseVariant function](https://github.com/tailwindlabs/tailwindcss/blob/c01b8254e822d4f328674357347ca0532f1283a0/packages/tailwindcss/src/candidate.ts#L511-L516).\r\n\r\n# **About me:**\r\n\r\nHey, my name is Ramu Narasinga. I study large open-source projects and create content about their codebase architecture and best practices, sharing it through articles, videos.\r\n\r\nI am open to work on interesting projects. Send me an email at ramu.narasinga@gmail.com\r\n\r\nMy Github — [https://github.com/ramu-narasinga](https://github.com/ramu-narasinga)\r\n\r\nMy website — [https://ramunarasinga.com](https://ramunarasinga.com/)\r\n\r\nMy Youtube channel — [https://www.youtube.com/@thinkthroo](https://www.youtube.com/@thinkthroo)\r\n\r\nLearning platform — [https://thinkthroo.com](https://thinkthroo.com/)\r\n\r\nCodebase Architecture — [https://app.thinkthroo.com/architecture](https://app.thinkthroo.com/architecture)\r\n\r\nBest practices — [https://app.thinkthroo.com/best-practices](https://app.thinkthroo.com/best-practices)\r\n\r\nProduction-grade projects — [https://app.thinkthroo.com/production-grade-projects](https://app.thinkthroo.com/production-grade-projects)\r\n\r\n# **References:**\r\n\r\n1. [https://github.com/tailwindlabs/tailwindcss/blob/next/packages/tailwindcss/src/utils/default-map.ts#L5](https://github.com/tailwindlabs/tailwindcss/blob/next/packages/tailwindcss/src/utils/default-map.ts#L5)\r\n    \r\n2. [https://github.com/tailwindlabs/tailwindcss/blob/c01b8254e822d4f328674357347ca0532f1283a0/packages/tailwindcss/src/design-system.ts#L40](https://github.com/tailwindlabs/tailwindcss/blob/c01b8254e822d4f328674357347ca0532f1283a0/packages/tailwindcss/src/design-system.ts#L40)\r\n    \r\n3. [https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global\\_Objects/Map](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Map)\r\n    \r\n4. [https://github.com/tailwindlabs/tailwindcss/blob/c01b8254e822d4f328674357347ca0532f1283a0/packages/tailwindcss/src/candidate.ts#L511-L516](https://github.com/tailwindlabs/tailwindcss/blob/c01b8254e822d4f328674357347ca0532f1283a0/packages/tailwindcss/src/candidate.ts#L511-L516)\r\n    \r\n\r\n[  \r\n](https://medium.com/tag/javascript?source=post_page-----dce5edc88a29--------------------------------)\r\n",
    "code": "var Component=(()=>{var o=Object.create;var i=Object.defineProperty;var m=Object.getOwnPropertyDescriptor;var u=Object.getOwnPropertyNames;var f=Object.getPrototypeOf,g=Object.prototype.hasOwnProperty;var b=(n,e)=>()=>(e||n((e={exports:{}}).exports,e),e.exports),w=(n,e)=>{for(var t in e)i(n,t,{get:e[t],enumerable:!0})},c=(n,e,t,l)=>{if(e&&typeof e==\"object\"||typeof e==\"function\")for(let s of u(e))!g.call(n,s)&&s!==t&&i(n,s,{get:()=>e[s],enumerable:!(l=m(e,s))||l.enumerable});return n};var y=(n,e,t)=>(t=n!=null?o(f(n)):{},c(e||!n||!n.__esModule?i(t,\"default\",{value:n,enumerable:!0}):t,n)),v=n=>c(i({},\"__esModule\",{value:!0}),n);var d=b((M,r)=>{r.exports=_jsx_runtime});var k={};w(k,{default:()=>p,frontmatter:()=>N});var a=y(d()),N={title:\"DefaultMap class in TailwindCSS source code.\"};function h(n){let e={a:\"a\",br:\"br\",code:\"code\",div:\"div\",h1:\"h1\",img:\"img\",li:\"li\",ol:\"ol\",p:\"p\",pre:\"pre\",span:\"span\",strong:\"strong\",...n.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(e.p,{children:[\"In this article, we analyse \",(0,a.jsx)(e.a,{href:\"https://github.com/tailwindlabs/tailwindcss/blob/next/packages/tailwindcss/src/utils/default-map.ts#L5\",children:\"DefaultMap class\"}),\" in Tailwind CSS source code. This is a map that can generate default values for keys that don\\u2019t exist. Generated default values are added to the map to avoid re-computation.\"]}),`\n`,(0,a.jsx)(e.div,{\"data-rehype-pretty-code-fragment\":\"\",children:(0,a.jsx)(e.pre,{\"data-language\":\"plaintext\",\"data-theme\":\"default\",children:(0,a.jsxs)(e.code,{\"data-language\":\"plaintext\",\"data-theme\":\"default\",children:[(0,a.jsx)(e.span,{className:\"line\",children:(0,a.jsx)(e.span,{})}),`\n`,(0,a.jsx)(e.span,{className:\"line\",children:(0,a.jsx)(e.span,{children:\"/**\"})}),`\n`,(0,a.jsx)(e.span,{className:\"line\",children:(0,a.jsx)(e.span,{children:\" * A Map that can generate default values for keys that don't exist.\"})}),`\n`,(0,a.jsx)(e.span,{className:\"line\",children:(0,a.jsx)(e.span,{children:\" * Generated default values are added to the map to avoid recomputation.\"})}),`\n`,(0,a.jsx)(e.span,{className:\"line\",children:(0,a.jsx)(e.span,{children:\" */\"})}),`\n`,(0,a.jsx)(e.span,{className:\"line\",children:(0,a.jsx)(e.span,{children:\"export class DefaultMap<T = string, V = any> extends Map<T, V> {\"})}),`\n`,(0,a.jsx)(e.span,{className:\"line\",children:(0,a.jsx)(e.span,{children:\"  constructor(private factory: (key: T, self: DefaultMap<T, V>) => V) {\"})}),`\n`,(0,a.jsx)(e.span,{className:\"line\",children:(0,a.jsx)(e.span,{children:\"    super()\"})}),`\n`,(0,a.jsx)(e.span,{className:\"line\",children:(0,a.jsx)(e.span,{children:\"  }\"})}),`\n`,(0,a.jsx)(e.span,{className:\"line\",children:(0,a.jsx)(e.span,{})}),`\n`,(0,a.jsx)(e.span,{className:\"line\",children:(0,a.jsx)(e.span,{children:\"  get(key: T): V {\"})}),`\n`,(0,a.jsx)(e.span,{className:\"line\",children:(0,a.jsx)(e.span,{children:\"    let value = super.get(key)\"})}),`\n`,(0,a.jsx)(e.span,{className:\"line\",children:(0,a.jsx)(e.span,{})}),`\n`,(0,a.jsx)(e.span,{className:\"line\",children:(0,a.jsx)(e.span,{children:\"    if (value === undefined) {\"})}),`\n`,(0,a.jsx)(e.span,{className:\"line\",children:(0,a.jsx)(e.span,{children:\"      value = this.factory(key, this)\"})}),`\n`,(0,a.jsx)(e.span,{className:\"line\",children:(0,a.jsx)(e.span,{children:\"      this.set(key, value)\"})}),`\n`,(0,a.jsx)(e.span,{className:\"line\",children:(0,a.jsx)(e.span,{children:\"    }\"})}),`\n`,(0,a.jsx)(e.span,{className:\"line\",children:(0,a.jsx)(e.span,{})}),`\n`,(0,a.jsx)(e.span,{className:\"line\",children:(0,a.jsx)(e.span,{children:\"    return value\"})}),`\n`,(0,a.jsx)(e.span,{className:\"line\",children:(0,a.jsx)(e.span,{children:\"  }\"})}),`\n`,(0,a.jsx)(e.span,{className:\"line\",children:(0,a.jsx)(e.span,{children:\"}\"})})]})})}),`\n`,(0,a.jsxs)(e.p,{children:[\"In JavaScript, we have a \",(0,a.jsx)(e.a,{href:\"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Map\",children:\"Map API\"}),\" but there is no DefaultMap. This DefaultMap is a custom class that extends Map in \",(0,a.jsx)(e.a,{href:\"https://github.com/tailwindlabs/tailwindcss/blob/next/packages/tailwindcss/src/utils/default-map.ts#L5\",children:\"Tailwind CSS source code\"}),\".\"]}),`\n`,(0,a.jsx)(e.p,{children:\"Let\\u2019s understand this code.\"}),`\n`,(0,a.jsx)(e.div,{\"data-rehype-pretty-code-fragment\":\"\",children:(0,a.jsx)(e.pre,{\"data-language\":\"plaintext\",\"data-theme\":\"default\",children:(0,a.jsxs)(e.code,{\"data-language\":\"plaintext\",\"data-theme\":\"default\",children:[(0,a.jsx)(e.span,{className:\"line\",children:(0,a.jsx)(e.span,{children:\"constructor(private factory: (key: T, self: DefaultMap<T, V>) => V) {\"})}),`\n`,(0,a.jsx)(e.span,{className:\"line\",children:(0,a.jsx)(e.span,{children:\"    super()\"})}),`\n`,(0,a.jsx)(e.span,{className:\"line\",children:(0,a.jsx)(e.span,{children:\"}\"})})]})})}),`\n`,(0,a.jsxs)(e.p,{children:[\"DefaultMap is a class that has a constructor that expects a factory function. super() calls the parent class\\u2019s constructor, in this case, this is Map API and factory function\\u2019s second parameter is self: DefaultMap<T, V> which means it has access to \",(0,a.jsx)(e.code,{children:\"Map\"}),\" instance.\"]}),`\n`,(0,a.jsx)(e.h1,{id:\"how-defaultmap-is-initialized\",children:(0,a.jsx)(e.strong,{children:\"How DefaultMap is initialized?\"})}),`\n`,(0,a.jsxs)(e.p,{children:[\"Let\\u2019s find an example where this DefaultMap is initialised. \",(0,a.jsx)(e.a,{href:\"https://github.com/tailwindlabs/tailwindcss/blob/c01b8254e822d4f328674357347ca0532f1283a0/packages/tailwindcss/src/design-system.ts#L40\",children:\"design-system.ts\"}),\" desmonstrates usage of DefaultMap.\"]}),`\n`,(0,a.jsx)(e.p,{children:(0,a.jsx)(e.img,{src:\"https://miro.medium.com/v2/resize:fit:875/1*UatBnuEnp1OsRHJnMUQj9Q.png\",alt:\"\"})}),`\n`,(0,a.jsx)(e.div,{\"data-rehype-pretty-code-fragment\":\"\",children:(0,a.jsx)(e.pre,{\"data-language\":\"plaintext\",\"data-theme\":\"default\",children:(0,a.jsxs)(e.code,{\"data-language\":\"plaintext\",\"data-theme\":\"default\",children:[(0,a.jsx)(e.span,{className:\"line\",children:(0,a.jsx)(e.span,{children:\"let parsedVariants = new DefaultMap(\"})}),`\n`,(0,a.jsx)(e.span,{className:\"line\",children:(0,a.jsx)(e.span,{children:\"                        (variant) => parseVariant(variant, designSystem)\"})}),`\n`,(0,a.jsx)(e.span,{className:\"line\",children:(0,a.jsx)(e.span,{children:\"                     );\"})})]})})}),`\n`,(0,a.jsxs)(e.p,{children:[\"Here \",(0,a.jsx)(e.code,{children:\"(variant) => parseVariant(variant, designSystem)\"}),\" becomes our factory method that adds a default if a key does not exist.\"]}),`\n`,(0,a.jsx)(e.div,{\"data-rehype-pretty-code-fragment\":\"\",children:(0,a.jsx)(e.pre,{\"data-language\":\"plaintext\",\"data-theme\":\"default\",children:(0,a.jsxs)(e.code,{\"data-language\":\"plaintext\",\"data-theme\":\"default\",children:[(0,a.jsx)(e.span,{className:\"line\",children:(0,a.jsx)(e.span,{children:\"return {\"})}),`\n`,(0,a.jsx)(e.span,{className:\"line\",children:(0,a.jsx)(e.span,{children:\"      kind: 'arbitrary',\"})}),`\n`,(0,a.jsx)(e.span,{className:\"line\",children:(0,a.jsx)(e.span,{children:\"      selector,\"})}),`\n`,(0,a.jsx)(e.span,{className:\"line\",children:(0,a.jsx)(e.span,{children:\"      compounds: true,\"})}),`\n`,(0,a.jsx)(e.span,{className:\"line\",children:(0,a.jsx)(e.span,{children:\"      relative,\"})}),`\n`,(0,a.jsx)(e.span,{className:\"line\",children:(0,a.jsx)(e.span,{children:\"  }\"})})]})})}),`\n`,(0,a.jsxs)(e.p,{children:[\"This is the value returned by \",(0,a.jsx)(e.a,{href:\"https://github.com/tailwindlabs/tailwindcss/blob/c01b8254e822d4f328674357347ca0532f1283a0/packages/tailwindcss/src/candidate.ts#L511-L516\",children:\"parseVariant function\"}),\".\"]}),`\n`,(0,a.jsx)(e.h1,{id:\"about-me\",children:(0,a.jsx)(e.strong,{children:\"About me:\"})}),`\n`,(0,a.jsx)(e.p,{children:\"Hey, my name is Ramu Narasinga. I study large open-source projects and create content about their codebase architecture and best practices, sharing it through articles, videos.\"}),`\n`,(0,a.jsxs)(e.p,{children:[\"I am open to work on interesting projects. Send me an email at \",(0,a.jsx)(e.a,{href:\"mailto:ramu.narasinga@gmail.com\",children:\"ramu.narasinga@gmail.com\"})]}),`\n`,(0,a.jsxs)(e.p,{children:[\"My Github \\u2014 \",(0,a.jsx)(e.a,{href:\"https://github.com/ramu-narasinga\",children:\"https://github.com/ramu-narasinga\"})]}),`\n`,(0,a.jsxs)(e.p,{children:[\"My website \\u2014 \",(0,a.jsx)(e.a,{href:\"https://ramunarasinga.com/\",children:\"https://ramunarasinga.com\"})]}),`\n`,(0,a.jsxs)(e.p,{children:[\"My Youtube channel \\u2014 \",(0,a.jsx)(e.a,{href:\"https://www.youtube.com/@thinkthroo\",children:\"https://www.youtube.com/@thinkthroo\"})]}),`\n`,(0,a.jsxs)(e.p,{children:[\"Learning platform \\u2014 \",(0,a.jsx)(e.a,{href:\"https://thinkthroo.com/\",children:\"https://thinkthroo.com\"})]}),`\n`,(0,a.jsxs)(e.p,{children:[\"Codebase Architecture \\u2014 \",(0,a.jsx)(e.a,{href:\"https://app.thinkthroo.com/architecture\",children:\"https://app.thinkthroo.com/architecture\"})]}),`\n`,(0,a.jsxs)(e.p,{children:[\"Best practices \\u2014 \",(0,a.jsx)(e.a,{href:\"https://app.thinkthroo.com/best-practices\",children:\"https://app.thinkthroo.com/best-practices\"})]}),`\n`,(0,a.jsxs)(e.p,{children:[\"Production-grade projects \\u2014 \",(0,a.jsx)(e.a,{href:\"https://app.thinkthroo.com/production-grade-projects\",children:\"https://app.thinkthroo.com/production-grade-projects\"})]}),`\n`,(0,a.jsx)(e.h1,{id:\"references\",children:(0,a.jsx)(e.strong,{children:\"References:\"})}),`\n`,(0,a.jsxs)(e.ol,{children:[`\n`,(0,a.jsxs)(e.li,{children:[`\n`,(0,a.jsx)(e.p,{children:(0,a.jsx)(e.a,{href:\"https://github.com/tailwindlabs/tailwindcss/blob/next/packages/tailwindcss/src/utils/default-map.ts#L5\",children:\"https://github.com/tailwindlabs/tailwindcss/blob/next/packages/tailwindcss/src/utils/default-map.ts#L5\"})}),`\n`]}),`\n`,(0,a.jsxs)(e.li,{children:[`\n`,(0,a.jsx)(e.p,{children:(0,a.jsx)(e.a,{href:\"https://github.com/tailwindlabs/tailwindcss/blob/c01b8254e822d4f328674357347ca0532f1283a0/packages/tailwindcss/src/design-system.ts#L40\",children:\"https://github.com/tailwindlabs/tailwindcss/blob/c01b8254e822d4f328674357347ca0532f1283a0/packages/tailwindcss/src/design-system.ts#L40\"})}),`\n`]}),`\n`,(0,a.jsxs)(e.li,{children:[`\n`,(0,a.jsx)(e.p,{children:(0,a.jsx)(e.a,{href:\"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Map\",children:\"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Map\"})}),`\n`]}),`\n`,(0,a.jsxs)(e.li,{children:[`\n`,(0,a.jsx)(e.p,{children:(0,a.jsx)(e.a,{href:\"https://github.com/tailwindlabs/tailwindcss/blob/c01b8254e822d4f328674357347ca0532f1283a0/packages/tailwindcss/src/candidate.ts#L511-L516\",children:\"https://github.com/tailwindlabs/tailwindcss/blob/c01b8254e822d4f328674357347ca0532f1283a0/packages/tailwindcss/src/candidate.ts#L511-L516\"})}),`\n`]}),`\n`]}),`\n`,(0,a.jsx)(e.p,{children:(0,a.jsxs)(e.a,{href:\"https://medium.com/tag/javascript?source=post_page-----dce5edc88a29--------------------------------\",children:[(0,a.jsx)(e.br,{}),`\n`]})})]})}function p(n={}){let{wrapper:e}=n.components||{};return e?(0,a.jsx)(e,{...n,children:(0,a.jsx)(h,{...n})}):h(n)}return v(k);})();\n;return Component;"
  },
  "_id": "blog/DefaultMap-class-in-TailwindCSS.mdx",
  "_raw": {
    "sourceFilePath": "blog/DefaultMap-class-in-TailwindCSS.mdx",
    "sourceFileName": "DefaultMap-class-in-TailwindCSS.mdx",
    "sourceFileDir": "blog",
    "contentType": "mdx",
    "flattenedPath": "blog/DefaultMap-class-in-TailwindCSS"
  },
  "type": "Doc",
  "slug": "/blog/DefaultMap-class-in-TailwindCSS",
  "slugAsParams": "DefaultMap-class-in-TailwindCSS"
}