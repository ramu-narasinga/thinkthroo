{
<<<<<<< HEAD
  "title": "WeakSet() in react-scan source code.\r",
=======
  "title": "WeakSet() in react-scan source code.",
>>>>>>> 442b740f3cf43317109944c6cf4b7ca543a8cddf
  "published": false,
  "featured": false,
  "component": false,
  "toc": true,
  "body": {
<<<<<<< HEAD
    "raw": "\r\nIn this article, we review a code snippet from [react-scan source code](https://github.com/aidenybai/react-scan/blob/main/packages/scan/src/core/index.ts#L609).\r\n\r\n```plaintext\r\nexport const ignoredProps = new WeakSet<\r\n  Exclude<ReactNode, undefined | null | string | number | boolean | bigint>\r\n>();\r\n\r\nexport const ignoreScan = (node: ReactNode) => {\r\n  if (node && typeof node === 'object') {\r\n    ignoredProps.add(node);\r\n  }\r\n};\r\n```\r\n\r\nI found this code snippet in a file, [core/index.ts](https://github.com/aidenybai/react-scan/blob/main/packages/scan/src/core/index.ts#L609). Why not use a proper Set? why would react-scan author decide to use WeakSet? To draw some conclusion around that, we first need to understand difference between WeakSet and Set in JavaScript.\r\n\r\n![](https://cdn-images-1.medium.com/max/1000/1*_cUOESQn8Ob47ZrLxtzD9g.png)\r\n\r\n### WeakSet\r\n\r\nA `WeakSet` is a collection of garbage-collectable values, including objects and [non-registered symbols](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Symbol#shared_symbols_in_the_global_symbol_registry). A value in the `WeakSet` may only occur once. It is unique in the `WeakSet`'s collection.\r\n\r\nRead more about [WeakSet](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/WeakSet).\r\n\r\n### Set\r\n\r\nThe `Set` object lets you store unique values of any type, whether [primitive values](https://developer.mozilla.org/en-US/docs/Glossary/Primitive) or object references.\r\n\r\nRead more about Set\r\n\r\n### WeakSet vs Set\r\n\r\nValues of WeakSets must be garbage-collectable. Most [primitive data types](https://developer.mozilla.org/en-US/docs/Glossary/Primitive) can be arbitrarily created and don’t have a lifetime, so they cannot be stored. Objects and [non-registered symbols](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Symbol#shared_symbols_in_the_global_symbol_registry) can be stored because they are garbage-collectable.\r\n\r\nThe main differences to the [`Set`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Set) object are:\r\n\r\n* `WeakSet`s are collections of objects and symbols only. They cannot contain arbitrary values of any type, as [`Set`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Set)s can.\r\n    \r\n* The `WeakSet` is *weak*, meaning references to objects in a `WeakSet` are held *weakly*. If no other references to a value stored in the `WeakSet` exist, those values can be garbage collected.\r\n    \r\n\r\nComing back to the code snippet in react-scan\r\n\r\n```plaintext\r\nexport const ignoreScan = (node: ReactNode) => {\r\n  if (node && typeof node === 'object') {\r\n    ignoredProps.add(node);\r\n  }\r\n};\r\n```\r\n\r\nNow it makes sense why typeof node === ‘object’ check is in place. Can you guess why? this is because only Object and Symbols can be stored in the WeakMap that are garbage collectable if they are not referenced elsewhere.\r\n\r\n### About me:\r\n\r\nHey, my name is [Ramu Narasinga](https://ramunarasinga.com). I study large open-source projects and create content about their codebase architecture and best practices, sharing it through articles, videos.\r\n\r\n***I am open to work on interesting projects. Send me an email at ramu.narasinga@gmail.com***\r\n\r\nMy Github —  [https://github.com/ramu-narasinga](https://github.com/ramu-narasinga)\r\n\r\nMy website —  [https://ramunarasinga.com](https://ramunarasinga.com/)\r\n\r\nMy Youtube channel —  [https://www.youtube.com/@thinkthroo](https://www.youtube.com/@thinkthroo)\r\n\r\nLearning platform —  [https://thinkthroo.com](https://thinkthroo.com/)\r\n\r\nCodebase Architecture —  [https://app.thinkthroo.com/architecture](https://app.thinkthroo.com/architecture)\r\n\r\nBest practices —  [https://app.thinkthroo.com/best-practices](https://app.thinkthroo.com/best-practices)\r\n\r\nProduction-grade projects —  [https://app.thinkthroo.com/production-grade-projects](https://app.thinkthroo.com/production-grade-projects)\r\n\r\n### References:\r\n\r\n1. [https://github.com/aidenybai/react-scan/blob/main/packages/scan/src/core/index.ts#L609](https://github.com/aidenybai/react-scan/blob/main/packages/scan/src/core/index.ts#L609)\r\n    \r\n2. [https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global\\_Objects/WeakSet](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/WeakSet)",
=======
    "raw": "\nIn this article, we review a code snippet from [react-scan source code](https://github.com/aidenybai/react-scan/blob/main/packages/scan/src/core/index.ts#L609).\n\n```plaintext\nexport const ignoredProps = new WeakSet<\n  Exclude<ReactNode, undefined | null | string | number | boolean | bigint>\n>();\n\nexport const ignoreScan = (node: ReactNode) => {\n  if (node && typeof node === 'object') {\n    ignoredProps.add(node);\n  }\n};\n```\n\nI found this code snippet in a file, [core/index.ts](https://github.com/aidenybai/react-scan/blob/main/packages/scan/src/core/index.ts#L609). Why not use a proper Set? why would react-scan author decide to use WeakSet? To draw some conclusion around that, we first need to understand difference between WeakSet and Set in JavaScript.\n\n![](https://cdn-images-1.medium.com/max/1000/1*_cUOESQn8Ob47ZrLxtzD9g.png)\n\n### WeakSet\n\nA `WeakSet` is a collection of garbage-collectable values, including objects and [non-registered symbols](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Symbol#shared_symbols_in_the_global_symbol_registry). A value in the `WeakSet` may only occur once. It is unique in the `WeakSet`'s collection.\n\nRead more about [WeakSet](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/WeakSet).\n\n### Set\n\nThe `Set` object lets you store unique values of any type, whether [primitive values](https://developer.mozilla.org/en-US/docs/Glossary/Primitive) or object references.\n\nRead more about Set\n\n### WeakSet vs Set\n\nValues of WeakSets must be garbage-collectable. Most [primitive data types](https://developer.mozilla.org/en-US/docs/Glossary/Primitive) can be arbitrarily created and don’t have a lifetime, so they cannot be stored. Objects and [non-registered symbols](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Symbol#shared_symbols_in_the_global_symbol_registry) can be stored because they are garbage-collectable.\n\nThe main differences to the [`Set`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Set) object are:\n\n* `WeakSet`s are collections of objects and symbols only. They cannot contain arbitrary values of any type, as [`Set`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Set)s can.\n    \n* The `WeakSet` is *weak*, meaning references to objects in a `WeakSet` are held *weakly*. If no other references to a value stored in the `WeakSet` exist, those values can be garbage collected.\n    \n\nComing back to the code snippet in react-scan\n\n```plaintext\nexport const ignoreScan = (node: ReactNode) => {\n  if (node && typeof node === 'object') {\n    ignoredProps.add(node);\n  }\n};\n```\n\nNow it makes sense why typeof node === ‘object’ check is in place. Can you guess why? this is because only Object and Symbols can be stored in the WeakMap that are garbage collectable if they are not referenced elsewhere.\n\n### About me:\n\nHey, my name is [Ramu Narasinga](https://ramunarasinga.com). I study large open-source projects and create content about their codebase architecture and best practices, sharing it through articles, videos.\n\n***I am open to work on interesting projects. Send me an email at ramu.narasinga@gmail.com***\n\nMy Github —  [https://github.com/ramu-narasinga](https://github.com/ramu-narasinga)\n\nMy website —  [https://ramunarasinga.com](https://ramunarasinga.com/)\n\nMy Youtube channel —  [https://www.youtube.com/@thinkthroo](https://www.youtube.com/@thinkthroo)\n\nLearning platform —  [https://thinkthroo.com](https://thinkthroo.com/)\n\nCodebase Architecture —  [https://app.thinkthroo.com/architecture](https://app.thinkthroo.com/architecture)\n\nBest practices —  [https://app.thinkthroo.com/best-practices](https://app.thinkthroo.com/best-practices)\n\nProduction-grade projects —  [https://app.thinkthroo.com/production-grade-projects](https://app.thinkthroo.com/production-grade-projects)\n\n### References:\n\n1. [https://github.com/aidenybai/react-scan/blob/main/packages/scan/src/core/index.ts#L609](https://github.com/aidenybai/react-scan/blob/main/packages/scan/src/core/index.ts#L609)\n    \n2. [https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global\\_Objects/WeakSet](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/WeakSet)",
>>>>>>> 442b740f3cf43317109944c6cf4b7ca543a8cddf
    "code": "var Component=(()=>{var p=Object.create;var c=Object.defineProperty;var m=Object.getOwnPropertyDescriptor;var b=Object.getOwnPropertyNames;var u=Object.getPrototypeOf,g=Object.prototype.hasOwnProperty;var f=(a,e)=>()=>(e||a((e={exports:{}}).exports,e),e.exports),y=(a,e)=>{for(var t in e)c(a,t,{get:e[t],enumerable:!0})},o=(a,e,t,i)=>{if(e&&typeof e==\"object\"||typeof e==\"function\")for(let r of b(e))!g.call(a,r)&&r!==t&&c(a,r,{get:()=>e[r],enumerable:!(i=m(e,r))||i.enumerable});return a};var S=(a,e,t)=>(t=a!=null?p(u(a)):{},o(e||!a||!a.__esModule?c(t,\"default\",{value:a,enumerable:!0}):t,a)),k=a=>o(c({},\"__esModule\",{value:!0}),a);var s=f((_,l)=>{l.exports=_jsx_runtime});var j={};y(j,{default:()=>h,frontmatter:()=>v});var n=S(s()),v={title:\"WeakSet() in react-scan source\\xA0code.\"};function d(a){let e={a:\"a\",code:\"code\",div:\"div\",em:\"em\",h3:\"h3\",img:\"img\",li:\"li\",ol:\"ol\",p:\"p\",pre:\"pre\",span:\"span\",strong:\"strong\",ul:\"ul\",...a.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(e.p,{children:[\"In this article, we review a code snippet from \",(0,n.jsx)(e.a,{href:\"https://github.com/aidenybai/react-scan/blob/main/packages/scan/src/core/index.ts#L609\",children:\"react-scan source code\"}),\".\"]}),`\n`,(0,n.jsx)(e.div,{\"data-rehype-pretty-code-fragment\":\"\",children:(0,n.jsx)(e.pre,{\"data-language\":\"plaintext\",\"data-theme\":\"default\",children:(0,n.jsxs)(e.code,{\"data-language\":\"plaintext\",\"data-theme\":\"default\",children:[(0,n.jsx)(e.span,{className:\"line\",children:(0,n.jsx)(e.span,{children:\"export const ignoredProps = new WeakSet<\"})}),`\n`,(0,n.jsx)(e.span,{className:\"line\",children:(0,n.jsx)(e.span,{children:\"  Exclude<ReactNode, undefined | null | string | number | boolean | bigint>\"})}),`\n`,(0,n.jsx)(e.span,{className:\"line\",children:(0,n.jsx)(e.span,{children:\">();\"})}),`\n`,(0,n.jsx)(e.span,{className:\"line\",children:(0,n.jsx)(e.span,{})}),`\n`,(0,n.jsx)(e.span,{className:\"line\",children:(0,n.jsx)(e.span,{children:\"export const ignoreScan = (node: ReactNode) => {\"})}),`\n`,(0,n.jsx)(e.span,{className:\"line\",children:(0,n.jsx)(e.span,{children:\"  if (node && typeof node === 'object') {\"})}),`\n`,(0,n.jsx)(e.span,{className:\"line\",children:(0,n.jsx)(e.span,{children:\"    ignoredProps.add(node);\"})}),`\n`,(0,n.jsx)(e.span,{className:\"line\",children:(0,n.jsx)(e.span,{children:\"  }\"})}),`\n`,(0,n.jsx)(e.span,{className:\"line\",children:(0,n.jsx)(e.span,{children:\"};\"})})]})})}),`\n`,(0,n.jsxs)(e.p,{children:[\"I found this code snippet in a file, \",(0,n.jsx)(e.a,{href:\"https://github.com/aidenybai/react-scan/blob/main/packages/scan/src/core/index.ts#L609\",children:\"core/index.ts\"}),\". Why not use a proper Set? why would react-scan author decide to use WeakSet? To draw some conclusion around that, we first need to understand difference between WeakSet and Set in JavaScript.\"]}),`\n`,(0,n.jsx)(e.p,{children:(0,n.jsx)(e.img,{src:\"https://cdn-images-1.medium.com/max/1000/1*_cUOESQn8Ob47ZrLxtzD9g.png\",alt:\"\"})}),`\n`,(0,n.jsx)(e.h3,{id:\"weakset\",children:\"WeakSet\"}),`\n`,(0,n.jsxs)(e.p,{children:[\"A \",(0,n.jsx)(e.code,{children:\"WeakSet\"}),\" is a collection of garbage-collectable values, including objects and \",(0,n.jsx)(e.a,{href:\"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Symbol#shared_symbols_in_the_global_symbol_registry\",children:\"non-registered symbols\"}),\". A value in the \",(0,n.jsx)(e.code,{children:\"WeakSet\"}),\" may only occur once. It is unique in the \",(0,n.jsx)(e.code,{children:\"WeakSet\"}),\"'s collection.\"]}),`\n`,(0,n.jsxs)(e.p,{children:[\"Read more about \",(0,n.jsx)(e.a,{href:\"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/WeakSet\",children:\"WeakSet\"}),\".\"]}),`\n`,(0,n.jsx)(e.h3,{id:\"set\",children:\"Set\"}),`\n`,(0,n.jsxs)(e.p,{children:[\"The \",(0,n.jsx)(e.code,{children:\"Set\"}),\" object lets you store unique values of any type, whether \",(0,n.jsx)(e.a,{href:\"https://developer.mozilla.org/en-US/docs/Glossary/Primitive\",children:\"primitive values\"}),\" or object references.\"]}),`\n`,(0,n.jsx)(e.p,{children:\"Read more about Set\"}),`\n`,(0,n.jsx)(e.h3,{id:\"weakset-vsset\",children:\"WeakSet vs\\xA0Set\"}),`\n`,(0,n.jsxs)(e.p,{children:[\"Values of WeakSets must be garbage-collectable. Most \",(0,n.jsx)(e.a,{href:\"https://developer.mozilla.org/en-US/docs/Glossary/Primitive\",children:\"primitive data types\"}),\" can be arbitrarily created and don\\u2019t have a lifetime, so they cannot be stored. Objects and \",(0,n.jsx)(e.a,{href:\"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Symbol#shared_symbols_in_the_global_symbol_registry\",children:\"non-registered symbols\"}),\" can be stored because they are garbage-collectable.\"]}),`\n`,(0,n.jsxs)(e.p,{children:[\"The main differences to the \",(0,n.jsx)(e.a,{href:\"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Set\",children:(0,n.jsx)(e.code,{children:\"Set\"})}),\" object are:\"]}),`\n`,(0,n.jsxs)(e.ul,{children:[`\n`,(0,n.jsxs)(e.li,{children:[`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.code,{children:\"WeakSet\"}),\"s are collections of objects and symbols only. They cannot contain arbitrary values of any type, as \",(0,n.jsx)(e.a,{href:\"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Set\",children:(0,n.jsx)(e.code,{children:\"Set\"})}),\"s can.\"]}),`\n`]}),`\n`,(0,n.jsxs)(e.li,{children:[`\n`,(0,n.jsxs)(e.p,{children:[\"The \",(0,n.jsx)(e.code,{children:\"WeakSet\"}),\" is \",(0,n.jsx)(e.em,{children:\"weak\"}),\", meaning references to objects in a \",(0,n.jsx)(e.code,{children:\"WeakSet\"}),\" are held \",(0,n.jsx)(e.em,{children:\"weakly\"}),\". If no other references to a value stored in the \",(0,n.jsx)(e.code,{children:\"WeakSet\"}),\" exist, those values can be garbage collected.\"]}),`\n`]}),`\n`]}),`\n`,(0,n.jsx)(e.p,{children:\"Coming back to the code snippet in react-scan\"}),`\n`,(0,n.jsx)(e.div,{\"data-rehype-pretty-code-fragment\":\"\",children:(0,n.jsx)(e.pre,{\"data-language\":\"plaintext\",\"data-theme\":\"default\",children:(0,n.jsxs)(e.code,{\"data-language\":\"plaintext\",\"data-theme\":\"default\",children:[(0,n.jsx)(e.span,{className:\"line\",children:(0,n.jsx)(e.span,{children:\"export const ignoreScan = (node: ReactNode) => {\"})}),`\n`,(0,n.jsx)(e.span,{className:\"line\",children:(0,n.jsx)(e.span,{children:\"  if (node && typeof node === 'object') {\"})}),`\n`,(0,n.jsx)(e.span,{className:\"line\",children:(0,n.jsx)(e.span,{children:\"    ignoredProps.add(node);\"})}),`\n`,(0,n.jsx)(e.span,{className:\"line\",children:(0,n.jsx)(e.span,{children:\"  }\"})}),`\n`,(0,n.jsx)(e.span,{className:\"line\",children:(0,n.jsx)(e.span,{children:\"};\"})})]})})}),`\n`,(0,n.jsx)(e.p,{children:\"Now it makes sense why typeof node === \\u2018object\\u2019 check is in place. Can you guess why? this is because only Object and Symbols can be stored in the WeakMap that are garbage collectable if they are not referenced elsewhere.\"}),`\n`,(0,n.jsx)(e.h3,{id:\"about-me\",children:\"About me:\"}),`\n`,(0,n.jsxs)(e.p,{children:[\"Hey, my name is \",(0,n.jsx)(e.a,{href:\"https://ramunarasinga.com\",children:\"Ramu Narasinga\"}),\". I study large open-source projects and create content about their codebase architecture and best practices, sharing it through articles, videos.\"]}),`\n`,(0,n.jsx)(e.p,{children:(0,n.jsx)(e.em,{children:(0,n.jsxs)(e.strong,{children:[\"I am open to work on interesting projects. Send me an email at \",(0,n.jsx)(e.a,{href:\"mailto:ramu.narasinga@gmail.com\",children:\"ramu.narasinga@gmail.com\"})]})})}),`\n`,(0,n.jsxs)(e.p,{children:[\"My Github\\u200A\\u2014\\u200A \",(0,n.jsx)(e.a,{href:\"https://github.com/ramu-narasinga\",children:\"https://github.com/ramu-narasinga\"})]}),`\n`,(0,n.jsxs)(e.p,{children:[\"My website\\u200A\\u2014\\u200A \",(0,n.jsx)(e.a,{href:\"https://ramunarasinga.com/\",children:\"https://ramunarasinga.com\"})]}),`\n`,(0,n.jsxs)(e.p,{children:[\"My Youtube channel\\u200A\\u2014\\u200A \",(0,n.jsx)(e.a,{href:\"https://www.youtube.com/@thinkthroo\",children:\"https://www.youtube.com/@thinkthroo\"})]}),`\n`,(0,n.jsxs)(e.p,{children:[\"Learning platform\\u200A\\u2014\\u200A \",(0,n.jsx)(e.a,{href:\"https://thinkthroo.com/\",children:\"https://thinkthroo.com\"})]}),`\n`,(0,n.jsxs)(e.p,{children:[\"Codebase Architecture\\u200A\\u2014\\u200A \",(0,n.jsx)(e.a,{href:\"https://app.thinkthroo.com/architecture\",children:\"https://app.thinkthroo.com/architecture\"})]}),`\n`,(0,n.jsxs)(e.p,{children:[\"Best practices\\u200A\\u2014\\u200A \",(0,n.jsx)(e.a,{href:\"https://app.thinkthroo.com/best-practices\",children:\"https://app.thinkthroo.com/best-practices\"})]}),`\n`,(0,n.jsxs)(e.p,{children:[\"Production-grade projects\\u200A\\u2014\\u200A \",(0,n.jsx)(e.a,{href:\"https://app.thinkthroo.com/production-grade-projects\",children:\"https://app.thinkthroo.com/production-grade-projects\"})]}),`\n`,(0,n.jsx)(e.h3,{id:\"references\",children:\"References:\"}),`\n`,(0,n.jsxs)(e.ol,{children:[`\n`,(0,n.jsxs)(e.li,{children:[`\n`,(0,n.jsx)(e.p,{children:(0,n.jsx)(e.a,{href:\"https://github.com/aidenybai/react-scan/blob/main/packages/scan/src/core/index.ts#L609\",children:\"https://github.com/aidenybai/react-scan/blob/main/packages/scan/src/core/index.ts#L609\"})}),`\n`]}),`\n`,(0,n.jsxs)(e.li,{children:[`\n`,(0,n.jsx)(e.p,{children:(0,n.jsx)(e.a,{href:\"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/WeakSet\",children:\"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/WeakSet\"})}),`\n`]}),`\n`]})]})}function h(a={}){let{wrapper:e}=a.components||{};return e?(0,n.jsx)(e,{...a,children:(0,n.jsx)(d,{...a})}):d(a)}return k(j);})();\n;return Component;"
  },
  "_id": "blog/WeakSet()-in-react-scan.mdx",
  "_raw": {
    "sourceFilePath": "blog/WeakSet()-in-react-scan.mdx",
    "sourceFileName": "WeakSet()-in-react-scan.mdx",
    "sourceFileDir": "blog",
    "contentType": "mdx",
    "flattenedPath": "blog/WeakSet()-in-react-scan"
  },
  "type": "Doc",
  "slug": "/blog/WeakSet()-in-react-scan",
  "slugAsParams": "WeakSet()-in-react-scan"
}